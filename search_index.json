[["index.html", "心理統計をもういちど はじめに", " 心理統計をもういちど Almond Fish 2024-05-27 はじめに 「心理統計をもういちど～総和記号の理解からはじめる統計再入門」を手にとっていただきありがとうございます。 私は、50代半ばで放送大学に入学してから、はじめて心理統計に出会いました。思い返すと、学び始めのころは、ほんとうに基本的なところで、とまどったり思いちがいをしたり、悪戦苦闘していたと思います。幸い、時間だけは余裕があったので、地元の図書館にもかよって、わからないところを別の教科書で読んだりしていました。そうこうしているうちに、私はある疑問をもち、それをなんとか自力で解決するという経験をしました。 その疑問とは、本書の第3章でとりあげている「平均値の移動と偏差平方和の過大評価」です。ごく簡単にいえば、それは、「分散を計算するときに、データの平均値が6.2だったら、四捨五入して、平均が6ということにして計算し、近似値をもとめてよいか」という疑問です。 その具体的な内容は本文にゆずりますが、数学があまり得意ではなかった私が、なんとか自力で解けるくらいの疑問ですから、専門家からは「自明」の一言で片づけられそうなものだと思います。それでも、苦心して疑問を解決したことは、私が統計学を学び続けるうえでの大きな力になりました。 私の疑問について、教科書に答えは書いてありませんでした。そのかわりに、「分散公式」という、分散の定義式によく似た式が紹介されていました。そして、分散の定義式を「分散公式」に変形する過程が、私の疑問をとくための大きなヒントになったのでした。さらに、そこには分散分析を理解するためのひとつのヒントがあると気づきました。 というわけで、本書では、私が私の疑問と出会い、それをなんとか解決し、分散分析の理解につなげていく過程を、ともに体験していただこうと思います。そのなかで、総和記号をふくんだ計算式のあつかい、分散という指標の意味、分散分析が分析しようとしていることなどについて、あらためて考えたり、理解をふかめたりしていただけたら幸いです。 本書の概要について記しておきます。第1章、第2章では、分散の定義式に登場する「総和記号」について解説しています。ややいかつい形をした総和記号が式に入っていると、なんだかそれだけで難しい式に見えてしまいますが、そんな読者の皆さんにも、この章で総和記号と和解していただこうと思います。第3章では、私の疑問について本格的に掘り下げています。第2章で解説した、総和記号をふくんだ式の変形方法をフル活用することで、私の疑問に明解な解が与えられます。 第4章では、分散分析の理解に不可欠な、推測統計と統計的仮説検定について解説しています。帰無仮説と対立仮説、自由度といった、推測統計における重要な概念をいくつかあつかっています。最後の第5章では、第3章、第4章での解説をもとに、分散分析では何をどう分析しようとしているのかについて解説しています。 本書は、別の教科書ですでに心理統計を学んだことのある方々を想定して書いていますが、はじめて心理統計にふれる方々にもお読みいただけるよう配慮したつもりです。ただし、前述した本書の概要から明らかなように、確率変数や確率分布、あるいは t 検定などについて、本書ではまったくふれていませんのでご注意ください。教科書ではなく、あくまでもサブテキストっぽい読み物という位置づけでお読みいただければと思います。それでは、どうぞ、最後までお付き合いください。 著者 "],["c1_sigma.html", "1 総和記号と和解しよう", " 1 総和記号と和解しよう 「はじめに」でお話ししたように、私の疑問は、分散の計算に関することでした。「分散」というのは、データの散らばりぐあいをあらわす指標です。言いかえると、データがどれくらい密集しているかあらわす指標です。値が大きければ、データが広い範囲に散らばっていると予想され、値が小さければ、データが狭い範囲に密集していると予想される、ということです。 分散を計算するには、個々のデータから、データの平均値を引いて、それを二乗して、、、と、ずいぶん面倒な計算が必要ですし、その前に平均値を計算しておく必要もあります。これらの計算の過程を式に表すとき、かならず登場するのが「総和記号」です。 本章ではまず、全体の導入として、総和記号と平均値について解説します。 "],["s11_about_sigma.html", "1.1 総和記号とは", " 1.1 総和記号とは 突然ですが、総和記号はお好きでしょうか。 総和記号ってな～に？という方のためにご紹介すると、こんな形をしている記号です。 \\[\\sum\\] 結構いかつい見た目をしていますね。この記号は、ギリシア文字のΣ（シグマ）の形です。Σはローマ字で言うと大文字のSです[*]。数学では、このΣの文字を合計（英語でSummation）の記号として使うのが一般的です。Excelの「合計」アイコンにもこの文字が使われています。 ＊だったらローマ字のSでいいのに、と思いたくなりますが、ただ「S」って書かれていても計算記号らしく見えないのでしょう。余談ですが、積分の記号（\\(\\int\\)）も、やはりSがもとになっています。「積」という字があるから掛け算っぽい感じがしますが、やっていることは足し算です。 1.1.1 総和記号のシグマくん あらためて、総和記号（\\(\\sum\\)）はお好きでしたか？ 統計をすでに学習した方は統計学の教科書で、そうでない方も、もしかしたら高等学校の数学の教科書で、この記号と出会ったかもしれません。総和記号なんか簡単じゃん？ という方もおられるでしょうが、結局よくわからなかったという方、こんな記号見たくもないという方も多いかもしれません。そこで本章では、この記号を少しでも身近に感じていただくために、「シグマくん」と愛称をつけて呼ぶことにします。初めまして、シグマくんです。 Figure 1.1: シグマくん ついでに、シグマくんといっしょに登場する小さい仲間を紹介しておきましょう。シグマくんのお腹のあたりにくっついているのは、通称「アイちゃん」、頭の上にのっかっているのは、通称「エヌちゃん」です。この子たちのはたらきと、そのふたごの友だちについては、いずれ紹介することにしましょう。 さて、シグマくんこと総和記号は、その名前の通り、「ぜんぶ足してください」という意味の記号です。ただし、シグマくんの前や後ろにくっついているものが、これまた統計学特有のややこしさをもっていますので、そのせいで、結構忌み嫌われているのかもしれません。 本章では、心理統計再入門の第一歩目として、シグマくんこと総和記号の意味について、解き明かしていきます。本格的な解説に入る前に、まずは「足し算」について復習します。 1.1.2 足し算の筆算としての総和記号 足し算といえば、 \\[3+5+2=10\\] のように、ノートの1行に、横向きに書いていたことも多いと思います。でも、桁数がふえたときには、 \\[4827+903+1872\\] ではなくて、 のように縦に並べて、桁を揃えて書いたと思います。これが足し算の筆算の書き方でしたね。珠算（そろばん）を習った方は、3つの数ではなく、もっとたくさんの数が積まれたものを、しかも途中に負の数が入っていたものを、そろばんで足し算するという練習を経験されたと思います。 シグマくんこと総和記号は、このような「数を積み上げておいて合計する」働きをもつと理解するのがよいと思います。つまり、筆算では一番下の行に書いてある「＋」の記号の代わりに、Σという記号を大きく書いている、そして、そこに並んでいる数を全部足し算して、合計を返してくるのだ、という風に理解するわけです。 マンガ的に言うと、縦に積まれた数を大きな口でぱくりと飲み込んで、合計を吐き出してくれる記号、といった感じです[*]。 Figure 1.2: 足し算して合計を吐き出す ＊イラストでは、シグマくんが「数を飲み込んで合計をはき出す」様を表現するために、シグマくんの中に数を詰め込むように書いていますが、実際には、このような表記はしません。また、総和記号の右側に、足し算する数を縦に積み上げるような書き方もしません。あくまでも、総和記号の働きをイメージしたイラストであるとご理解ください。 合計する数たちを、筆算のように縦に積み上げても、横に並べても、計算としては全く同じことをしています。本章であえて縦に積み上げる書き方をしているのは、後の章でお話する総和記号の性質が、より視覚的に理解しやすいと思うからです。 "],["s12_solve_sigma.html", "1.2 総和記号の読み解き方", " 1.2 総和記号の読み解き方 シグマくんこと総和記号は、足し算の筆算をしているかのように理解するのがよい、というのが本書の立場なのですが、いくつか補足しておきたいことがあります。 総和記号が合計するのは、「あるまとまりをもった数たち」である。 総和記号が表すのは、「あるまとまりをもった数たち」の「合計」という1つの数である。 「あるまとまりをもった数たち」にいくつの数が含まれているのかわからないこともある。 順に説明をしていきましょう。 1.2.1 変数とデータ 足し算は、何でも数が２つ以上集まれば足していいのではありません。足し算して合計した数が「何を表しているか」が明らかになっているから、計算する意味があるのです。 こんな設定で考えてみましょう。 設定 放送大学で学んでいる社会人学生の方に、「一日に何分くらい読書をしますか」をたずねました。Aさんは10分、Bさんは45分、Cさんは5分、などと、10人から回答が得られたとしましょう。このとき、集まってきた「数たち」、つまり「10,45,5,…」はそれぞれの学生が、一日に読書をする時間（分）を表しています。この数たちは「一日の読書時間」とまとめられます。 いろいろな人に「一日の読書時間」についてたずねると、人によって回答する数が（たまたま同じになることはあっても）異なるのが普通ですね。このようなものを「変数」といいます。人によって答える「数」が「変わる」からです。「一日の読書時間」は「変数」の例です[*]。 ＊「変数」といっても、勝手に数を変えていいとか、突然数が変わるという意味ではありません。調査に答えてくれる人がかわると、回答も変わる、という意味で「変わる」のです。実験に参加する人がかわると、結果の数値も変わる、という意味で「変わる」のです。回答された数値、実験で得られた数値を、あとから変えてしまうのは「捏造」です。決してやってはいけません。 そして、調査した相手から帰ってきた回答である、「10,45,5,…」などを「データ」といいます[*]。一つひとつを区別して、1個目のデータは10です、と言うときもあれば、全部をまとめて「読書時間」というデータの合計は…、のように言うときもあります。 ＊ここでは、読書時間を「何分」という数で回答してもらっていますから、そのまま合計したり、平均したりできます。が、「10分未満」「10分から30分」「30分から1時間」「1時間以上」のように選択肢から選んでもらう方法もあります。このような回答も「データ」です。ただしこの場合には、単純に合計や平均をすることができません。 教科書で数式の説明をするときには、「読書時間」などのような具体的な名前ではなく、Xなど、何にでも読み替えられる単純な名前がついています。これらのことをふまえて、以下、本書では次のような書き方をしていきます。 読書時間=(10,45,5,20,3,20,30,60,15,8) このように書いて、「読書時間」という変数には、「10,45,5,…」の10個の「データ」がふくまれていることを表します。 変数名 統計学で、よくXとかYとかの文字が出てきて、また記号ばっかりで書いて～！と、思ったことがあるかもしれません。「一日の読書時間」みたいなわかりやすい名前ではないですが、これらも、何かのデータを指していると考えましょう。もっと意味のわかる名前だったらいいのに、というのはその通りなのですが、こう考えてみましょう。「好きな名前に、好きなように言い換えられるように、あえて特徴のない名前にしている」のだと。 だから、Xとか出てきたら、「うーん、これはファミレスのメニューの、美味しさ点数ということにしておこう」とか、Yとか出てきたら、「よし、これは毎朝目覚めたときの、私の気分の良さの点数と考えておこう」とか、好きなように読み替えればいいのです。そして、「それって、本当に統計をとるとしたら、どうやって数字に直せばいいんだろう？」と考えがふくらんだら、あなたはもう心理学者だし、統計家です。 1.2.2 総和記号が表すのはひとつの数 シグマくんこと総和記号を紹介した時に、縦にたくさん積まれた数たちを飲みこんでいる様子をイラストにしました。といっても、総和記号が出てくるたびに、こんなふうに筆算に書き直すわけではありませんし、合計の計算を電卓で行うわけでもありません。 総和記号は形がごついので、なんだか複雑な意味を表しているかのように感じてしまうかもしれません。でもこれは、「データの合計」というひとつの数を表しているにすぎません。ですから、どの変数の合計なのかがわかれば、具体的な数がわからなくても式が書けるのです。たとえば、前述した「読書時間」の合計を示すときには、「\\(\\sum\\)読書時間」のように書くだけです。「読書時間」は具体的な数がわかっていますから、後から合計を計算して、総和記号のかわりに具体的な合計の数値を書き入れれば、計算が続けられます。 だったら、なぜはじめから合計を計算して数で書かないのでしょうか。それは、実際に調査や実験をしてみないと、データがどんな値なのかわからない、そもそもデータがいくつあるのかもわからないからです。そんなときにも、式を書いて分析方法を決めておくことはできるし、そうすることはとても大事なのです。 データ分析と料理 ここで述べていることは、要するに、調査や実験をする前に、計算方法や分析方法を決めておく、という考え方だと理解してください。データ分析はよく料理にたとえられますが、料理と根本的に異なるのは、データという材料が手に入ってから料理方法を考えているのではないことです。料理であれば、「おいしそうなアジが手に入った。どうやって食べようか？」という発想をすることがありますが、データ分析では、「いい感じのデータが手に入った。どうやって分析しようか？」という順序では考えない、ということです。原則として、こういう目的でこういうデータを集め、こういう分析方法で分析をしたい、というように、方法を決めるのが先です。 1.2.3 データが何個あるのかわからない ここまでは、放送大学の学生10人に、一日の読書時間をたずねたという想定で話をしてきました。が、実際に何かを明らかにしたくて調査をするときには、もっと多くの人に答えてもらうこともあります。1000人に答えてもらおうとして調査の案内をしても、かならず全員に答えていただけるとは限らないので、実際に何人分の回答が集まるかは、実際に集めてみないとわからないのです。 ですから、「変数」にいくつの数がふくまれるかわからない状態でも式が書けるようにするために、とりあえずn人として式を書きます。調査が終わってみたら、1000人にお願いしたけれど892人から回答があったということであれば、n=892と決まります。このnのことを、標本サイズ（サンプルサイズ）といいます[*]。 ＊「標本」（サンプル）については後の章で説明します。ここでは、「標本サイズ（サンプルサイズ）」とは「データ数」のことだと理解してください。n=892は、何らかの変数に892個の数が入っているという意味です。 ＊よく似た言葉に標本数（サンプル数）というのがありますが、これはさしあたり「調査した回数」と理解しましょう。「読書時間」について、A学習センターで調査し、同じことを、比較のためにB学習センターでも調査したということであれば、標本数（サンプル数）は2である、といいます。厳密さには欠けますが、この理解で大きな間違いはありません。 1.2.4 データをもれなく呼び出す工夫 前節で、データ数をnという記号で書くことを説明しました。ここで、シグマくんこと総和記号の仲間である「アイちゃん」と「エヌちゃん」について紹介することにしましょう。 データの個数をあらわずエヌちゃん エヌちゃんは、上で説明したように、データの個数を表します。実際に個数がわかっているときには、データの個数を数字で書くことがありますが、そうでないときにはnとだけ書きます。 エヌちゃんのふたごのきょうだいに、エムちゃんがいます。２つのグループに調査をして、ひとつ目のグループからn人分のデータが集まったとします。ふたつ目のグループのほうもnにしてしまうと、「どっちもn人で同じなのだな」と思わせてしまったり、「人数が同じでないといけないのだな」と思い込ませてしまったりするかもしれません。そこで、記号を変えてmとします。こうして記号を使い分けることで、「nとmは違う数でもいいし、たまたま同じであってもいい」という意味を伝えているわけです。 データに出席番号をつけるアイちゃん アイちゃんは何をしているかというと、データに出席番号をつけています。さきほどの「一日の読書時間」で考えると、10人分のデータはこうなっていました。 読書時間=(10,45,5,20,3,20,30,60,15,8) 10個のデータが並んでいますから、出席番号を〈読書時間i〉と、右下に小さく添え字で書くことにし[*]、前から順番に、1番、2番と番号をつけて、〈読書時間1〉〈読書時間2〉のように表します。1番のデータ（i=1）は10で、2番のデータ（i=2）は45です。出席番号を、どのように決めるかという決まりは特にありません。他のデータと区別できればそれでよいのです。そして、1番から順番にデータを呼び出して、総和記号がおこなう合計の計算に加わってもらい、エヌちゃんが示している数までよんだら、データを全部呼んだことになります。もれなく、ダブりなく、全部のデータをちゃんと合計するために、アイちゃんとエヌちゃんは重要なのです。 ＊出席番号にiという文字を使うのは慣例です。多くのプログラミング言語で、同じ処理を反復させるときに、反復回数を示すためにiという文字を使います。このiは、繰り返すという意味の英単語iterateあるいはその名詞形iterationの頭文字です。総和記号の場合は、iで示された出席番号のデータを順に呼び出して、「合計に加える」という処理を繰り返している、と解釈できます。 エヌちゃんに、エムちゃんという双子のきょうだいがいたように、アイちゃんにも、ジェイちゃん（j）という双子のきょうだいがいます。2つのグループがあるとき、1つ目のグループは、アイちゃんが1からnまで順番にデータをよび、2つめのグループは、ジェイちゃんが1からmまで順番にデータをよぶ、というように、ペアになって仕事をしています。 1.2.5 合計したくないデータの扱い データの中には、合計したくない値が含まれていることがあります。 ひとつは「欠損値」です。質問が書かれていたのに回答してもらえなかった、あるいは、回答するのをとばされてしまった、というとき、「～番目のデータは欠損値だ」とか、「欠損値が～件あった」のように言います。こういうときには、適当な数を補って合計するという手法もありますが、合計に加えないことも多いです。統計ソフトは、数値の代わりに特定の記号を書いておくと、そこだけは合計の計算から除外してくれます。 もう一つは、いわゆる「外れ値」や「異常値」です。他の人のデータと比較して、あまりにも大きすぎたり小さすぎたりするときには、それを「外れ値」として除外することが検討され得ます。また、あり得ない値のときには、「異常値」として除外することもあります。「一日の読書時間（分）」が、480なら前者の例、-1なら後者の例です。ただし、外れ値を除外するべきかどうかは、単純に判断できることではありません。 "],["s13_about_mean.html", "1.3 総和記号の使い道（１）平均", " 1.3 総和記号の使い道（１）平均 シグマくんこと総和記号について少し知っていただいたところで、シグマくんの使い道についてみていきましょう。まず「平均」についてです[*]。平均の計算方法は、「データを合計して、データ数で割る」でした。この「データを合計して」の部分に総和記号が登場します。 ＊本書で扱う「平均」は、相加平均（または算術平均）と呼ばれるものです。これ以外にも、相乗平均（または幾何平均）、調和平均など、意味の異なる算出方法がいくつかありますが、本書では触れません。 では、「データを合計して、データ数で割る」という方法で求められた「平均」は、どういう意味のある値なのでしょうか。本節では、「平らに均した量としての平均」および「データの重心としての平均」という２つの考え方を紹介します。どちらも正しい考え方で、どちらが良いとか良くないという話ではありません。どちらの理解もそれなりに意味があり、どちらの理解も重要です。が、統計学では後者の考え方がより重要です。 1.3.1 平らに均した量としての平均 「平らに均した量としての平均」を考えるために、次のような例題を用います。 例題 コップにジュースが注いであります。1つ目のコップには2の目盛りまで、2つ目のコップには6の目盛りまで、3つ目のコップには7の目盛りまでジュースが入っています。3人の子どもがケンカしないように平等にしたいのですが、どうすればいいでしょうか（注：コップの大きさ、目盛りの付け方は3つとも同じであるとします）。 Figure 1.3: 例題1 「コップに注ぎ分けるのではなくて、紙パックの小さいやつを子どもの数だけ買った方がいいと思う」という賢い解決法もありますが、今はそういう回答を求めているのではありません。 多い少ないのデコボコをなくす ジュースの量が多いコップ、つまり7や6まで入っているコップから、2までしか入っていないコップに少しだけ分けてあげる、というのは自然な発想のひとつですね。デコボコをなくして平らにする、多いところから少ないところへ移動する。これが「平均する」の基本的な考え方です。図にするとこんな感じでしょうか。右の図では、3つのコップのジュースの量が均等に近づきました。とはいえ、少々まどろっこしいですね。 Figure 1.4: 方法1：多いところから少ないところへ移動する いったん集めて配り直す いったん全部集めて、ジュースがどれくらいあるか測って、どれくらいずつ分ければいいか考えてから、もう一回コップに注ぐ、という方法もあります。同じような目盛りのついた、もっと背の高いコップを用意して全部まとめてやると、ちょうど2+6+7=15の目盛りまでジュースが入りました。15÷3=5なので、どのコップにも目盛り５まで入るように分ければ解決します。こちらのほうが、算数っぽいやり方でしょう。図にするとこんな感じでしょうか。 Figure 1.5: 方法2 大きなコップに集めて配り直す 合計してnで割る これが平均の一つ目の考え方です。つまり、多いところと少ないところの差をなくす、デコボコをなくして平らに均す。つまり、集めて均等に配り直した量が平均である、と理解できます。小さい子どもにも比較的理解しやすい考え方だと思います。「集めて配り直す」という方法は、計算方法の理解を助けます。「背の高いコップに全部集める」のは、つまり合計するということ、「同じ量になるように分ける」のは、つまりn（この場合は子どもの人数である3）で割るということです。 1.3.2 データの重心としての平均 今度は、「データの重心としての平均」を考えるために、次のような例題を用います。 例題 等間隔に穴のあいた長い棒を用意して、穴の位置に1から順に番号をふります。いま、2の位置、6の位置、7の位置に1個ずつ、合計3個の、同じ重さのおもりがぶら下がっています。この棒のどこかの穴にひもを通してぶら下げたとき、棒が並行になる（つり合う）ためには、どの穴にひもを通したらよいでしょうか。 Figure 1.6: 例題2 棒の重さは考えなくていいのか、とか、ちょうど釣り合う穴がないときはどうするのか、という疑問はもっともです。ここでは、棒の重さは無視してください。ちょうど釣り合う穴がないときには、簡単に、望む位置に、新しい穴があけられると仮定してください。 棒を傾けようとする力を考える 直観的に考えて、2や7の位置にひもを通しても、つり合うとは思えませんね。おもりの下がっている3か所のだいたい真ん中あたりにしようとするのが妥当な考え方でしょう。ですから、4か5のあたりにひもを通すと、ちょうどつり合いそうだなと予想できます。実際、この場合は5のところにひもを通すとつり合います。 このことをもう少し分解して考えてみましょう。 2の位置にあるおもりは、おもり1個分の力で棒を左に傾けようとします。6の位置のおもりも、7の位置のおもりも、それぞれ、おもり1個分の力で棒を右に傾けようとします。だったら、おもりの数の多い右側に棒は傾きそうに思えますが、そうはなりません。ひもを通す位置と、おもりの位置との距離が問題なのです。 棒を傾けようとする力の大きさは、おもりの重さと、ひもの位置からの距離の積で決まります。このことは、シーソー遊びを思い浮かべると納得できると思います。大人と子ども一人ずつでシーソー遊びをするとき、同じ位置に座るのではなくて、大人が前の方に（シーソーの中心に近い方に）すわると、うまく遊ぶことができます。子どもは体重が軽いので、その分、シーソーの中心からの距離を長くすることで、シーソーを傾ける力が大きくなり、うまく大人とつり合いをとることができるのです。 距離の合計が等しくなるようにする 5の位置のひもを通すとして考えましょう。おもりはすべて同じ重さですから、ひもの位置からの距離だけに注目して考えます。 2の位置にあるおもりは、ひもの位置から左側に3目盛り離れていますから、棒を3の力で左に傾けようとします。6と7の位置にあるおもりは、それぞれ、ひもの位置から右に1目盛り、同じく右に2目盛り離れていますから、それぞれ1の力、2の力で棒を右に傾けようとします。右左を比べてみると、左側も右側も、棒を傾けようとする力は3ずつで等しくなり、つり合うことになります。このとき、ひもの位置（5の位置）が重さの中心になっているということができ、この位置を「重心」といいます。重りはすべて同じ重さ、という条件があるので、重心からの距離の合計が同じになるように、重心を決めればよいのです。 Figure 1.7: 左右の距離の合計が等しいとつり合う 4の位置を重心にしようとしても、つり合いません。図で示したように、左側の距離は2、右側の距離の合計は2+3=5で、等しくならないからです。 Figure 1.8: 左右の距離の合計が等しくないとつり合わない 重心の位置を計算する では、重心の位置をどうやって計算したらよいのでしょうか。答えだけを先に書くと、データ（この場合、おもりをぶら下げた位置を示す数）の平均値が重心の位置になります。これについては後の章で詳しく書きます。 重心が定まれば、データが重心からどれだけ離れているかは、引き算をすればわかります。また、どちらの方向に離れているかも、符号で表すことができます。 上の例（釣り合っている例）でいうと、「2」というデータから、重心の「5」を引くと、2-5=-3となります。これは、重心からマイナスの方向（左方向）に3だけ離れていることを意味しています[*]。「6」や「7」についても同様にすると、6-5=1、7-5=2となり、それぞれ、重心からプラスの方向（右方向）に1あるいは2だけ離れていることを意味していて、右方向の合計は「3」です。 左右の距離の合計は、どちらも3になっています。距離の合計の絶対値が等しいので、つり合います。符号をつけたまま計算すれば、「-3」と「3」で合わせて0になります。符号付きで計算した距離の合計が0になるとき、つり合います。どちらのやり方でも、つり合っていることを確かめることができます。 ＊マイナスの方向がなぜ左方向かというと、数を直線上に並べるときには、通常、左から右へ増加するように書くからです。0を中心においたとき、左側は負の数、右側は正の数になっています。 重要なのは平均からの距離 平均について2つの考え方を紹介しましたが、統計学でより重要なのは「重心」としての平均という考え方です。それぞれのデータが、平均からどれだけ離れているのか、あるいは平均にどれだけ近いのかが、大事な意味を持つということです。 例題で、棒におもりをぶら下げて釣り合わせる課題を設定しましたが、棒を反対側からみても、やっていることは同じです。また、数字の付け方も、左から「1,2,3…」と書いても、左から「100,101,102,..」と書いても、あるいは、左から「-1,-2,-3,…」と書いても、やっていることは同じです。重心の位置とおもりの位置との関係が変化しないのであれば、目盛りの数字のつけ方が変わっても、データの本質は変わりません。つまり、データというのは、「それぞれの値がいくつなのか」よりも、「それぞれの値が平均からどのくらい離れているか」のほうが、より本質的なのだともいえるのです。 Figure 1.9: 逆側から見ても、目盛りのつけ方を変えても、やっていることは同じ "],["s14_calc_mean.html", "1.4 平均の計算を読み解く", " 1.4 平均の計算を読み解く では、平均の計算を、シグマくんこと総和記号をつかって書いてみましょう。 本書ではこのあとも、数式やその変形過程の解説を何度か行いますが、基本的に、図であらわしている計算式はn=3やn=5程度の具体的な数値で、本来の数式はデータ数をnとしてより一般的な形で書いていきます。両方を見比べながら、どこでどのような計算が行われているのかについて、理解をふかめてください。 1.4.1 平均の計算式 平均の計算式は、前節で確かめたように、「データを合計してデータ数で割る」でした。前節で用いたデータx=(2,6,7)をもちいて、図で書くとこうなります。一般的な数式が図の下側に併記してあります。 平均は、データを合計して、データ数nで割って算出します。総和記号をつかっている部分がデータを合計している部分です。数式のxiが、図では「2,6,7」というデータに置き換わっていることに注目してください。シグマくんのまわりに細かい記号がいくつもくっついているので、とても複雑なことをしているように見えてしまいますが、すでにお話ししたように、シグマくんは足し算の筆算（の答えを表している記号）です。お口の中に、データをぎゅっと詰め込んで、がんばって合計を計算しているシグマくんを、どうぞ可愛がってやってください。 ＊シグマくんこと総和記号を、足し算の筆算に置きかえることの良さを、ここで感じていただけるでしょうか。筆算を使わずに、\\(\\frac13 \\times (2+6+7)\\)のように横に展開してしまうと、かっことか足し算記号とか、記号が増えすぎて見づらいのです。筆算の形にすることで、\\(\\sum\\)の記号全体がひとつの「かたまり」である（つまり、合計という一つの数である）ということが、より直感的に理解できると思います。 総和記号の前の\\(\\frac1n\\)が、データ数nで割っている部分です。ここでは、3で割る、という計算を、\\(\\frac13\\)を掛けるという計算に、nで割る、という計算を、\\(\\frac1n\\)を掛けるという計算に書き換えています。割り算は、基本的に分数の形で書く、というのが、数学の世界の慣例になっています。 そして、数式の右辺に書いてある記号は、平均値をあらわす記号です。\\(\\bar x\\)と書いて、「エックスバー」とよみます。「xの平均」つまり、xというデータの平均値のことを、\\(\\bar x\\)と書きます。 データを合計したものをnで割りますから、きれいに割り切れるとは限りません。というより、割り切れないことのほうが圧倒的に多いはずです。この場合、平均値をできるだけ正確に表そうとして、計算機や表計算ソフトが示した数値をそのまま、小数点以下5桁も6桁も書いているのを見かけることがありますが、意味のないことです。では何桁まで書けばよいのでしょうか。吉田（1998）によれば、「ロー・データの桁（有効数字）よりも2つ下の桁までで十分だと思います」（吉田(1998),p.43）とのことです。心理学で扱うことが多い心理尺度のデータでは、個々のデータは1桁の整数であることがほとんどなので、それらを平均した値としては、小数第2位までが妥当でしょう。また、小数ではなく分数のままにしておくという方法も、数学の答案ではよく見かけますが、論文やレポートの中で、平均値を分数で書くことは行われていません。 ところで、「データを合計したものをnで割る」という計算のはずなのに、計算式は「÷n」ではなく「\\(\\frac1n\\)」としたことも、数学の世界の慣例だとお話ししました。この章の最後に、分数についてすこし復習しておきましょう。 1.4.2 分数とは割り算 分数とは、要するに割り算です。 「何かをいくつかに分ける」という計算があります。例えば２という数があってそれを５で割る。具体的な場面では、たとえば2リットルのビールを5人で分けるときなどです。このとき、 \\[2 \\div 5\\] と割り算で書くと思います。この割り算の結果は、小数で書くと2÷5=0.4となりますが、分数で書くと、割り算の式をそのまま変形した形で、\\(2 \\div 5 = \\frac25\\)となります。このあたりの手続きに苦手意識を感じている方もおられるでしょう。 まず、2÷5という式に使われている割り算記号「÷」は、どの国でも通用するわけではありません。割り算の記号としては、スラッシュ（／）が多数派で、「÷」は少数派です。Excelの数式を書いたことがある方は、2÷5という割り算を2/5と書くことをご存知でしょう。コンピュータの世界ではスラッシュしか使いません（そもそも「／」のキーはあっても「÷」というキーはありません）。そう考えると、学校教育の段階から、スラッシュで書くことを教えてもいいかもしれませんね。 それから分数の読み方ですが、日本語では分母（横線の下にある方）を先に読みます。つまり、\\(\\frac25\\)を「５ぶんの２」と読みます。でも、英語では2/5と書いたものを、そのまま前から順に読み上げます。つまり、two-fifthとか、two over fiveなどと読むのです[*]。overのところを「割る」に置き換えれば、「2/5=two over five=2わる5」と、次の図のように、つなげて覚えられます。自分が理解しやすい書き方や読み方を身につけてください。 ＊このような読み方は、分数を英語で読むときの一つの方法で、ほかにもいろいろな表現があります。詳しくはWikipedia（英語版） https://en.wikipedia.org/wiki/Fraction をご覧ください。 "],["c2_transform.html", "2 総和記号の変身術と平方和", " 2 総和記号の変身術と平方和 第1章で見たように、総和記号は、データの合計という数を表していました。が、総和記号が登場するのは、1データを単純に合計する場面だけではありません。2つのデータを足し合わせたものを合計する、データに別の数を足したり引いたりしたもの、さらにそれを二乗したりしたものを合計するなど、さまざまです。このとき、書かれた計算式のとおりに計算するのではなく、計算式をより簡単な形に書き変える方法があるのです。それが、本章で紹介する3つの変身術です。変身術を用いて計算式を変形することで、計算が簡単になるだけでなく、データの性質について、新たな気づきが得られることもあります。 "],["s21_transform1.html", "2.1 第一の変身術「分身」", " 2.1 第一の変身術「分身」 さっそく、第一の変身術「分身」についてお話しします。が、その前に、三つの変身術の説明で共通して使う設定を書いておきます。 2.1.1 設定：5人の子どもを連れてスーパーでお買い物 ５人の子どもを連れて、スーパーにお買い物に来ました。子どもの名前はたいして重要ではないので、仮に「あき、いく、うみ、えな、おと」としておきましょう。 「じゃあみんな、好きなおやつを選んでください。え？ジュースも買いたいのですね。それでは、」 設定1：ジュースも、好きなのを選んできていいですよ。 設定2：ジュースは、みんな同じの（特売のやつ）にしておきましょうね。 設定3：ジュースも選んでいいですよ。おや、セットで買うとおやつが2割引きだそうです。やったね。 それぞれの設定のとき、5人分のおやつとジュースの値段の合計がどうなるかを、総和記号をつかって表していきます。なお、説明を単純にするために、本章では、消費税を考慮に入れません。 では、変身術のひとつめ「分身」の説明にうつりましょう。設定はこうでした。 設定1 ：好きなおやつを選ぶ。ジュースも好きなのを選ぶ。 5人の子どもの選んだおやつとジュースの値段を表にしました。おやつの値段もジュースの値段も、5人ともばらばらです。 Figure 2.1: 設定1：好きなおやつと好きなジュース 5人分のおやつとジュースの値段を合計するとき、どんなふうに計算しますか？ 実際に計算しなくてもかまわないので、計算の順序を考えてみてください。ここでは5人分のデータしかないので、どう計算しても簡単なのですが、本章の例題の目的は、数式の変形について理解を深めるためですので、計算順序をすこしていねいに（若干くどく）考えていきます。具体的な数と記号による数式とを対比しながら、数式への理解をふかめてください。 2.1.2 第一の方法：おやつセットはそれぞれいくらか 第一の方法は、5人のおやつセットがそれぞれいくらかを先に計算し、それを合計する方法です。図を見ながら、計算順序をていねいに追いかけてみましょう。計算手順がややくどく感じられるでしょうが、具体的な数値をつかって、どんな順序で計算が進んでいくかを確かめてみることは、とても大事な作業です。 おやつとジュースの値段を具体的に数に置き換え、それぞれのおやつセットの値段を計算します（青い矢印の部分）。数式では、かっこの中の足し算に相当します。 おやつセットの値段を合計しました（オレンジ色の矢印の部分）。ここでシグマくんが活躍します。合計は1550円でした。 Figure 2.2: 方法1：セットの値段を先に計算する この計算方法で、シグマくんこと総和記号が登場するのは、最後におやつセットの値段を合計するところ（図のオレンジ色の矢印の部分）です。数式を見てください。総和記号の右側の足し算が、かっこでくくられていることに注意しましょう。まずかっこの中を計算する、その答え（おやつセットの値段）をシグマくんにわたす、シグマくんが「おやつセット」の値段を合計する、という手順で計算が進みます。かっこの終わりまでで、「おやつセットの値段の合計」という、一つの数を表しています。 2.1.3 第二の方法：おやつの合計とジュースの合計はそれぞれいくらか 第二の方法は、まずおやつの合計とジュースの合計をそれぞれ計算します。さいごに合計どうしを足し算するという方法です。図を見ながら、計算順序をていねいに追いかけてみましょう。 シグマくんこと総和記号を2つに「分身」させました。おやつ担当のシグマくん（オレンジ色）と、ジュース担当のシグマくん（黄緑色）です。 おやつの合計と、ジュースの合計をそれぞれ求めました。シグマくんは、それぞれ、「おやつの値段の合計」、「ジュースの値段の合計」という数に置き換わりました。総和記号の役割はここで終わりです。 おやつの値段の合計とジュースの値段の合計を足し算しました。合計は1550円でした。 Figure 2.3: 方法2：それぞれの合計をまず計算する この計算方法だと、シグマくんこと総和記号が登場するのは、おやつの合計をするときと、ジュースの合計をするとき2回（図のオレンジ色の2本の矢印）です。図と数式をくらべてみましょう。総和記号の後にかっこでくくられた式があり、その中で足し算や引き算が行われているときは、その足し算や引き算の位置で、総和記号を「分身」させることができるのです。 「分身」する前とあとを見比べても、「分身」することのメリットがあまり感じられないかもしれません。「分身」をしたほうが計算が簡単になる感じがあまりしませんし、シグマくんが2つに増えて、かえってやっかいな感じが増したかもしれません。が、「分身」させることの良さが本当にわかるのはここからです。 "],["s22_transform2.html", "2.2 第二の変身術「エヌ倍」", " 2.2 第二の変身術「エヌ倍」 変身術のふたつめは「エヌ倍」です。設定はこうでした。 設定2：好きなおやつを選ぶ。ジュースはみんな同じものにする。 5人の子どもの選んだおやつとジュースの値段を表にしました。こんどは、ジュースの値段が5人とも同じです。 Figure 2.4: 設定2：好きなおやつとみんな同じジュース 先ほどと同じように、計算の順序を考えてみてください。もちろん、それぞれのおやつセットの値段を計算してから合計する、という方法でも計算できます。が、もう少し簡単な方法があります。ジュースの値段はみんな同じ、というところがポイントです。ここだけは掛け算が使えそうですね。そのためには、まず、おやつとジュースを分けなくてはなりません。 2.2.1 第一段階：「分身」させる ジュースの方だけは掛け算で計算したい、というアイデアを実現するために、まず、前節でやったように「分身」させましょう。図を見ながら、計算順序をていねいに追いかけてみましょう。 シグマくんこと総和記号を2つに「分身」させました。おやつ担当のシグマくん（オレンジ色）と、ジュース担当のシグマくん（黄緑色）です。 Figure 2.5: 第一段階：分身 ここで、ジュース担当のシグマくんに注目しましょう。数式をよく見ると、設定1のときとは重要な違いがあります。どこが違うでしょうか。 2.2.2 出席番号のないデータ 重要な違いは、「ジュース」の値段が5人とも同じであることです。数式ではyに添え字がないことです（yiではなく単にyになっています）。出席番号がついていないのです。少々くどいですが、大事なことなので、ていねいに確認します。 「設定1」のときの数式では、ジュースの値段をyiと書いていました（前節の数式を見なおしてください）。このデータでは、5人ともジュースの値段が異なっていますから、出席番号をつけて区別しなくてはいけません。今考えているのとは別の場面で、おやつセットの値段を考える必要が出てきたら、主席番号をもとにして、おやつの値段とジュースの値段を正しく組み合わせなければなりません。 しかし、今回の「設定2」では、ジュースの値段yを、出席番号なしで書いています。なぜなら、ジュースは5人とも同じ値段で、区別する必要がないからです。確認すると、添え字がある場合とない場合とでは、次のことが違います。 添え字がついているデータは、出席番号ごとに値が異なる可能性がある（たまたま同じになる可能性はある）。また、同じ出席番号の別のデータと照合する場面があり得る。 添え字がついていないデータは、出席番号によらず、かならず同じ値である。 数式では添え字があるかないかの、一見小さな違いですが、見逃してはいけない違いです。 2.2.3 第二段階：「エヌ倍」に置き換える というわけで、ジュース担当のシグマくんは、掛け算に書き換えられます。具体的に数値で考えながら、続きの手順を見ていきます。 ジュースは全部同じ値段（80円）でした。同じ値段が人数分（ここでは5人分）なので、80×5という掛け算と同じです。 掛け算に書き換えたので、シグマくんの出番はありません。ここが「エヌ倍」の変身術を使った場面です。80円が5人分なので「80×5」になっています。 ジュースの合計を掛け算を使って計算しました（緑色の矢印）。 おやつの合計とジュースの合計を足し算しました。合計は1500円でした。 Figure 2.6: 第二段階：エヌ倍 図では5人分でしたから（つまりn=5でしたから）、×5という式になっています。が、数式では（人数が特定できないので）×nになります。そこで、この変身を「エヌ倍」と呼んでいます[*]。 ＊当然ですが、掛け算ですので、80×5と書いても、5×80と書いても同じことです。教科書に出てくる数式の変形では、後者のようにnを前におく形が好まれるようです。文字式の場合は、掛け算記号をつかわずに、単にnyと表記するのが普通です。 2.2.4 総和記号の守備範囲に注意 少々細かいことですが、総和記号の守備範囲について書いておきます。何を言っているかというと、次の2つの式は意味が違う、ということです。赤い三角形の印が、総和記号の守備範囲の終わりを示しています。 はじめの式（A）では、総和記号の後ろにかっこがあります。ですから、総和記号の守備範囲は、「かっこが閉じられるまで」です。つまり、〈おやつi＋ジュース〉という足し算を先にしてから、それを合計していく計算です。「ジュース」に添え字がないので、5人とも同じジュースを買っています。 あとの式（B）では、総和記号の後ろにかっこがありません。そして、〈おやつi〉の次に足し算記号がありますから、シグマくんの守備範囲は、この「足し算記号の前まで」です。シグマくんは〈おやつi〉だけを合計します。その後の「ジュース」は、総和記号とは関係のない数です。ということは、おやつは5つありますが、ジュースは1つだけです。 以上の説明を図にしてみます。かっこのあるなしで、計算の意味が大きく違ってしまうことに注意してください。 総和記号は、他の記号よりも大きくて、ごつい見た目をしているので、ついつい、「この記号がこの式全部をまとめている」みたいに錯覚するかもしれませんが、決してそんなことはありません。以前に書いたように、総和記号は「データの合計」というひとつの数を表しているに過ぎません。 "],["s23_transform3.html", "2.3 第三の変身術「後がけ」", " 2.3 第三の変身術「後がけ」 変身術のさいごは「後がけ」です。設定はこうでした。 設定3 ：好きなおやつとジュースを選ぶ。セットのときはおやつが２割引きになる。 5人の子どもの選んだおやつとジュースの値段を表にしました。「2割引きになる」を、「もとの値段（定価）の8割（80%）になる」と読み替えて表を作ってあります（コラム「2割引き」も参照）。先ほどと同じように、計算の順序を考えてみてください。 Figure 2.7: 設定3：セットのときはおやつが2割引き 2.3.1 第一段階：「分身」させる おやつのほうにだけ、2割引きが適用されるという設定なので、おやつとジュースを別々に考えたいところです。というわけで、ここでも「分身」させましょう。図を見ながら、計算順序をていねいに追いかけてみましょう。 シグマくんこと総和記号を2つに「分身」させました。おやつ担当のシグマくんと、ジュース担当のシグマくんです。 Figure 2.8: 第一段階：分身 ここで、おやつ担当のシグマくんに注目しましょう。おやつ一つひとつに「×0.8」がくっついています。この「×0.8」を、5回もしなくてはいけないのでしょうか。1回でまとめてできないでしょうか。 2.3.2 分配法則を逆向きに おやつ一つひとつにくっついている「×0.8」を、もう少し要領よく計算するために、分配法則の考え方を使います。「分配法則」は、次のような計算法則でした。 \\[(a + b) \\times c = a \\times c + b \\times c\\] 具体的な数に置き換えると、 \\[(200 + 300) \\times 0.8 = 200 \\times 0.8 + 300 \\times 0.8 = 400\\] となります。足し算してから0.8をかけても、1つずつに0.8をかけてから足し算しても、同じ答えになります。「後がけ」の変身術では、分配法則を逆向きに使います[*]。すなわち、 \\[200 \\times 0.8 + 300 \\times 0.8 = (200 + 300) \\times 0.8\\] ということです。 ＊分配法則を逆向きに、という言い方をしていますが、共通項をくくり出して因数分解する、という言い方の方が適切でしょう。ただ、因数分解というと、\\(x^2-y^2=(x+y)(x-y)\\)のような文字式ばかり思い浮かべてしまいそうなので、このような書き方をしています。 2.3.3 第二段階：後がけ 分配法則を逆向きに使って、おやつ担当のシグマくんを書き換えてみます。シグマくんこと総和記号が担当するのは、かっこの中の足し算部分ですから、×0.8は、シグマくんの前に出しておきます。計算手順の続きはこうなります。 おやつ担当シグマくんを「後がけ」で変身させます。おやつ一つひとつにくっついていた「×0.8」をひとまず取り除き、シグマくんの前に1つだけ「0.8×」と書いておきます。 それぞれのシグマくんの合計を計算します（オレンジ色の矢印）。おやつの方は、合計に0.8を掛けます。 おやつの（2割引き後の）合計と、ジュースの合計を足し算して、答えは1330円です。 Figure 2.9: 第二段階：後がけ 数式では、総和記号を「分身」させるところまではこれまでと同じです。そのあと、「×0.8」を総和記号の前に出してから、計算を進めています。「×0.8」が「×n」や「÷n」でも、同じように「後がけ」にすることができます[*]。 ＊「後がけ」と言いながら「×0.8」と前に出しているのは、後ろにくっつけてしまうと、シグマくんの守備範囲がどこまでかわかりにくくなるからです。実際、〈Σおやつi×0.8〉という式は、〈おやつi〉に0.8を掛けてから合計するのか、合計してから掛け算するのか区別できません（この場合、計算結果は同じになるので実用上は困りませんが）。「後がけ」は、「あとから（＝合計してから）掛け算する」という意味で、数式の「後の方に書く」という意味ではありません。（だったら「前がけ」でいいのでは？というのはもっともです。でも、「後がけ」のほうが語呂がよかったのです、はい。） また、「÷n」は割り算ですが、「\\(\\times \\frac1n\\)」と掛け算に直すことができます。やはり、「後わり」ではなく、「後がけ」といいます。 2割引き 「2割引き」や「25％OFF」などの言い回しを日常的によく見かけると思います。念のために確認すると、これは、 「２割引き」とは、もとの価格（定価）の2割を、もとの価格（定価）から値引きすること 「25％OFF」とは、もとの価格（定価）の25％を、もとの価格（定価）から値引きすること という意味ですね。もとの価格（定価）が600円の商品の場合、 「２割引き」では、もとの価格（定価）の2割（600×0.2=120）、つまり120円値引きするので、600-120=480円。 「25％OFF」では、もとの価格（定価）の25％（600×0.25=150）、つまり150円値引きするので、600-150=450円。 「2割=0.2」、「25％=0.25」と、正しく小数に直して計算することが大事です。また、 もとの価格（定価）2割引き＝もとの価格（定価）の8割で売る、つまり600×0.8=480円。 もとの価格（定価）25％引き＝もとの価格（定価）の75％で売る、つまり600×0.75=450円。 と置き換えることができると、より計算が簡単になります。本文でも、「2割引きになる」を、「8割になる」と読み替えて計算を進めています。 "],["s24_calc_deviation.html", "2.4 総和記号の使い道（２）偏差の総和", " 2.4 総和記号の使い道（２）偏差の総和 前章「総和記号の使い道（１）」の中で、データの重心としての平均について書きました。そのときに、重心からの距離の合計が、左右で（負の方向と正の方向で）等しくなることについて説明しました。つまり、偏差の合計は0になるのでした。 ここでは、偏差の合計が0になることを、シグマくんこと総和記号を使った数式で確かめていきましょう。仮想データとして、x=(1,4,7,8,10)というn=5のデータを用います。xの平均（\\(\\bar x\\)）は6です。具体的な数値を使った計算と、一般的な数式での計算を比較しながら、数式についての理解をふかめてください。偏差の合計をdsと書くことにすると[*]、計算式はこうなります。 ＊偏差は英語でdeviationなので、その頭文字をとり、合計であることを示すsをつけて、dsとしています。 数式を観察しましょう。シグマくんこと総和記号の守備範囲はかっこの終わりまでです。かっこの中に引き算がありますから、ここで「分身」できることがわかります。 2.4.1 第一段階：「分身」させる かっこの中の引き算の位置で「分身」させましょう。 Figure 2.10: 第一段階：分身 2.4.2 第二段階：二つ目のシグマくんは「エヌ倍」にする 二つ目のシグマくん（B）の中にはいっているのは、平均値です。添え字がついていないことに注目しましょう。添え字、すなわちデータの出席番号がついていないときは（いつも同じ値なので）掛け算に書き直していい、というのが、「エヌ倍」の変身術でした。合計しているものが\\(\\bar x\\)という、統計学っぽい記号になっていますが、平均値を表すただの記号です。見た目に惑わされず、出席番号（i）のあるなしで、「エヌ倍」が使えるかどうかを判断しましょう。 総和記号Bを「エヌ倍」に変身させると、こうなります。 Figure 2.11: 第二段階：Bは「エヌ倍」に もうこれ以上先に進めないのか、というと、そうではありません。 2.4.3 平らに均した量としての平均 前章の「平均」についての解説で、「平らに均した量としての平均」について書きました。ジュースを3人で分ける例題を思い出してください。同じことを、5人のジュースの量が1,4,7,8,10であるとして考えましょう。コップに入っているジュースの量はばらばらでしたが、同じ量ずつ分けるために、一度大きなコップに集めてから割り算をします。このとき、「大きなコップに集めたジュースの量」は、どのように表せるでしょうか。 表し方は二通りあります。図と見比べながら読んでください。 全部のコップに入っていた、ばらばらなジュースの量を合計すればよい。一般的な数式で書くと、\\(\\sum_{i=1}^n x_i\\)ということ。 n個のコップに均等にジュースを分けたのだから、分ける前に戻すには、どれかのコップのジュースの量（つまりジュースの量の平均）をn倍すればいい。一般的な数式で書くと、\\(n \\bar x\\)ということ。 ここから、1と2は同じ量を表しているので、等号でつなぐことができますね。数式で書くとこうなります。 これを使って、さきほどの数式を考えましょう。 2.4.4 第三段階：データの合計＝平均のエヌ倍 上で確かめたように、データの合計は、平均のn倍と等しいので、一つ目の総和記号(A)も、\\(n \\bar x\\)と書き換えることができます。したがって、次のように、どちらの総和記号も\\(n \\bar x\\)になりますから、引き算すれば0です。 Figure 2.12: 第三段階：そして0に これで、偏差の総和が0になることを確かめられました[*]。 ＊このことは、\\(\\sum_{i=1}^n (x_i-C) =0\\)という数式を解くことでも証明できます。ある定数Cを考え、データからCを引いた総和が0になるとすると、Cはどのような値かを考えます。この式を解くと、\\(C = \\bar x\\)を導くことができ、ある定数Cはデータの平均値であることを示せます。 "],["s25_calc_sumofsquare.html", "2.5 総和記号の使い道（３）偏差平方和", " 2.5 総和記号の使い道（３）偏差平方和 前節では、偏差の合計が0になることを、数式で確かめました。本節では、偏差の二乗について考えます。 偏差は、データから平均値を引いた値でした。それを二乗したのが「偏差平方」（偏差二乗ともいう）、それを合計したのが「偏差平方和」（偏差二乗和）です[*]。単に「平方和」と書くこともあります。「平方和」は英語でSum of Squaresなので、頭文字をとってSSと略記することにします。 ＊「平方」は、「同じ数を二度かけ合わせること」（広辞苑）で、要するに「二乗」と同じです。「二乗」は「2乗」「自乗」とも書きます。教科書によって使っている言い方が違うことがありますが、これらは同じ意味です。本書では、計算の方法を示すときにはおもに「二乗」や「二乗する」を、計算された値を示すときにはおもに「平方」を使用しています。 計算の手順通りに数式に表すと、下のようになります。だんだんと数式の見た目が複雑になってきましたが、この数式が扱えるようになると、統計学はだんぜん面白くなると思います。がんばりましょう。 \\[SS = \\sum_{i=1}^n (x_i - \\bar x)^2\\] はじめに、シグマくんこと総和記号の守備範囲を確かめておきましょう。かっこがありますから、かっこの最後までが守備範囲です。注意したいのは、二乗の計算です。同じ数を２回掛け合わせるのが「二乗する」という計算ですから、無理やり書き直すと、下図の最右辺のようになります。つまり、「二乗する」という計算も、シグマくんの守備範囲にふくまれています。 なぜ偏差を二乗するのか このことについて、統計学の教科書ではさまざまに説明されていると思います。 偏差を2乗しないで足し合わせれば、その数は必ず0となる。これは、平均値よりも大きい値と小さい値が相殺してしまうからだ。（林(2012)「社会統計学入門」） のような説明が多いかもしれません。偏差の絶対値をもとに算出される指標もありますが（たとえば平均絶対偏差＝偏差の絶対値を平均した指標など）、推測統計ではほぼ使われません。なぜかというと、 符号をなくすのには絶対値でもいいのですが，絶対値は数式で書けないから使いにくい（小杉(2023)「心理学データ解析基礎」） 数学者たちが「分散を散らばりの指標にすると、シンプルで美しい理論の体系を構築できる」と、数々の定理の発見を通して、確信し続けてきた（中原(2022)「基礎から学ぶ統計学」） などの数学的な背景があるからです。より本質的には、おそらく、「平均から離れた位置にあるデータは、そもそも発生確率がとても低い。ということは、情報価値が高い。よって、その価値をより高く評価するために二乗するのだ」と考えることもできます。 2.5.1 偏差平方を平均したものが分散 本書ではこのあとしばらく、「偏差平方和」についてお話ししますが、多くの統計学の教科書では、「偏差平方和」ではなく、「分散」について解説しているものが多いと思います。分散は、偏差平方和をデータ数（自由度）で割ったものです。わたしもそうでしたが、こうやっていろいろな用語がどんどん出てくると、それらがどんな関係だったのかわからなくなるのが、初学者あるあるです。偏差平方和の計算のお話にすすむ前に、用語どうしの関係を、下の図をつかって整理しておきましょう[*]。 Figure 2.13: 用語どうしの関係 ＊中央値とか四分位数とかはどこに位置づくのか、と疑問に思われるかもしれません。平均値や分散が、すべてのデータを使って計算する指標であるのに対して、中央値や四分位数は、データを昇順にならべたときの位置（並び順）だけできまります。つまり、「値の決まり方」が大きく異なるのです。そういうわけで、この図には書き入れてありません。 まず、グレーの四角形は「n個あるデータ」を表しています。平均値を引いても（偏差になる）、それを二乗しても（偏差平方になる）、それが「n個ある」ことは変わりません。データが姿を変えただけで、データ数がへったわけではありません。 青い矢印は合計する計算を、青い楕円は、矢印の出発点にある値の合計を表します。合計しているので、データ数がどれだけ多くても、1つの値になります。シグマくんこと総和記号が活躍するのはこの場面です。偏差平方和はこの段階の値です。ただし、「合計」しただけの値なので、データ数が大きいほど大きい値になります。1つの値になってはいますが、もとのデータ数が異なるデータどうしでは、単純に比較できません。 オレンジ色の破線はnで割る計算を、オレンジ色のひし形は合計をnで割った値（平均した値）を表します。統計学の教科書にかならず登場する「平均」や「分散」などはこの段階の値です。データ数で割っているので、当然1つの値です。データ数が異なるデータどうしでも、比較することができますが、測定単位などが異なっていると、やはり比較できません。 最後に標準偏差です。これだけは平方根をとるという特別な計算がはいっています。なぜかというと、偏差平方を計算するときに単位がかわってしまっているのと、数が大きくなりすぎているので、それをもとに戻すためです。 2.5.2 「平均する」という動詞 余計なことかもしれませんが、「平均する」という書き方に注意してください。通常、平均値とは「データを平均したら6.2でした」のように、《データをそのまま「合計してnで割る」と、6.2になった》ということです。このようにして求めた値のことを「平均値」あるいは単に「平均」といいます。ただし、「平均」という語にはもう一つの使い方があります。前述の太字の部分、「合計してnで割る」という計算の仕方を、「平均する」あるいは「～の平均」と表現します。 分散の計算では、 まず偏差をもとめてそれを2乗します。偏差の2乗を「合計してnで割る」と分散が求められます。 と書くところを、 まず偏差をもとめてそれを2乗します。偏差の2乗を「平均する」と分散が求められます。 と書いているわけです。あるいは、次のようにも書きます。 まず偏差をもとめてそれを2乗します。偏差の2乗「の平均」が分散です。 これら3つの文（A～C）は同じ意味を表しています。すなわち、「平均」という語が「合計してn割る」という計算方法の意味で使われているのです[*]。 ＊同じような使い方をする語に「合計」があります。これも、「全部足した値」という意味と、「全部足す」という計算方法の意味とがあります。 2.5.3 平均値が小数なら、丸めて計算してもいいのか さて、「偏差の二乗について考えます」といいながら、式を提示しただけで何も解説していません。偏差二乗和の計算式について考察するのは、本書前半の最重要課題ですので、次の章に回します。その前に、なぜこの式を取り上げるのかについて、「はじめに」で書いたことを、もうすこし詳しくお話ししておこうと思います。 私が放送大学に入学して2年目、はじめて「心理統計学」を学びはじめたころのことです。私が疑問に思ったのは次のことです。 データの平均値と分散を求めなさい、という試験問題が出ているときに、データを平均したら6.2になりました。それを見て、「平均したらちょうど6になるように問題を作ってくれればいいのに」と思ったのです。分散の計算がとてもやっかいだからです。具体的には、次のような状況です。 データをx=(2,4,7,8,10)とします。平均値は6.2です。偏差は、2-6.2=-4.2、二乗すると、(-4.2)×(-4.2)=17.64…。これをあと4回やって、合計して、また5で割って…と考えると、計算量の多さにいやけがさしてしまったのです。 だから「分散公式」（次章で解説します）を使えばいい、と教科書には書いてあります。だけど、そんなの使わなくたって、平均値を丸めて計算したらいいのではないでしょうか？ 正しい平均値は6.2だけど、平均値が6ということにして、近似値を計算したらいいのではないでしょうか。そうすれば、偏差は2-6=-4で、2乗すると16。データも平均値も整数であれば、分散の計算はとても簡単になります。 でも、ひょっとして、平均値を丸めてしまったら、分散の計算結果がとんでもないことになるのでしょうか。もしそうだったら困ります。 さて、読者のみなさんはどう思われますか？ 次の章から、この問題を解決していきます。 "],["c3_variance.html", "3 分散公式を読み解く", " 3 分散公式を読み解く 前章の最後に書いた私の疑問について、読者のみなさんはどう思われましたか。丸めて計算するなんてとんでもない、と思われましたか。それとも、近似値がわかりそうだから、別にいいんじゃないの、と思われましたか。本章では、この疑問を順に解決していきます。そのために、私の疑問の中にも登場した「分散公式」について話す必要があります。まず、分散公式について紹介するところからはじめましょう。 "],["s31_variance_theory.html", "3.1 分散公式とは", " 3.1 分散公式とは 「分散公式」というのは、電卓を使って分散を計算するときに、まともに（つまり定義式どおりに）計算するよりも簡単に計算できる公式のことです。次の式です。左辺の\\(s^2\\)は、分散を意味しています。 \\[ s^2 = \\frac1n\\sum_{i=1}^n x_i^2 - {\\bar x}^2 \\qquad \\cdots \\cdots \\mathrm{(3.1)} \\] ここで注意したいのは、シグマくんこと総和記号の守備範囲は、\\(x_i^2\\)までだということです。総和記号のすぐ後にかっこがないので、引き算記号があらわれたところで、守備範囲は終了しています。 いっぽう、分散の定義式はこうです。 \\[ s^2 = \\frac1n\\sum_{i=1}^n (x_i - \\bar x)^2 \\qquad \\cdots \\cdots \\mathrm{(3.2)} \\] こちらは、総和記号のすぐあとにかっこがありますから、かっこの終わりまで（正確には2乗の計算が終わるまで）が総和記号の守備範囲です。 分散は、偏差平方和をデータ数nで割ったものですから、偏差平方和をもとめる式に、\\(\\frac1n\\)をくっつけた形をしています。どちらの式も、使われている記号たちはとてもよく似ているのに、かっこがあったりなかったりして、微妙に違うことで、よけいに難しく感じたのを覚えています。 統計学の教科書によると、電卓を使う場合には、下の式（3.2式）で計算するよりも、上の式（分散公式、3.1式）で計算する方が計算が簡単らしいのです。どちらを使って計算しても同じ結果になるのですから、この2つの式は等号で結ぶことができます。つまり、下の式（分散の定義式）を、上の式（分散公式）に変形できるらしいのです。 そうだよ、そんなの知っている、という方は、もう本書を読む必要はないかもしれません。こういうの苦手だという方こそ、ぜひお付き合いください。式を変形していく過程で、シグマくんこと総和記号の変身術が見事に生かされるのを目撃することができるはずです。 3.1.1 ゴール地点を確かめよう このあと、分散の定義式（3.1式）の式変形をすすめていきます。かなり長い話になるので、最初に、式変形のゴール地点を確かめておきましょう。ただし、以下で行う数式変形では、式の最初にくっついている\\(\\frac1n\\)を省略した形で行います。少しでも数式がすっきりしたほうが見やすいでしょうし、また、データ数nで割るという計算は最後に行えばよいこと、場合によっては(n-1)で割る場合もあることなどがその理由です（（n-1）で割る理由は後述）。したがって、式変形のゴール地点は、次の形です。 \\[ \\begin{aligned}\\displaystyle SS &amp;= \\sum_{i=1}^n (x_i - \\bar x)^2 \\\\ &amp;= \\cdots \\cdots \\\\&amp;= \\sum_{i=1}^n x_i^2 - n {\\bar x}^2 \\end{aligned} \\] １行目のSSは、偏差平方和を表す記号で、その次の式が、偏差平方和を計算する式です。分散の定義式をn倍した形です。この式の先頭に\\(\\frac1n\\)をつけると、分散の定義式（3.2式）になります。そして一番下の行が、式変形の目的地点で、分散公式をn倍した形です。やはり先頭に\\(\\frac1n\\)をつけると、分散公式（3.1式）になります。問題は、この変形の途中経過です。 前章と同じように、仮想データとして、x=(1,4,7,8,10)というn=5のデータを用います。平均は\\(\\bar x=6\\)です。具体的な数値を使った計算と、一般的な数式での表現を比較しながら、数式についての理解をふかめてください。では、はじめていきましょう。 3.1.2 第一段階：二乗の計算の展開 最初に、二乗の計算を展開します。\\((x_i - \\bar x)^2\\)というところを展開してしまうのです。ちょっとだけ復習しますと、中学校の数学で、文字の式を展開したり、因数分解したり、ということを習ったと思います。こんなやつです。 \\[(a-b)^2 = (a-b)(a-b) =a^2 - 2ab + b^2\\] ほかにもいくつかの形を、公式として学習したのではないかと思います。どうしてこんな復習をしているかというと、\\((x_i - \\bar x)^2\\)という部分が、添え字がついたりバーが付いたりしてややこしく感じられるので、そういう方（かつての私です）には、aをxiに、bを\\(\\bar x\\)に置き換えて考えたほうがいいと思ったからです。ふたつの式を並べてみましょう。 たしかに同じつくりをしていることがおわかりでしょうか。でも、わたしたちが変形しようとしている式は、総和記号がくっついています。いまやったのは、総和記号の守備範囲の中だけを（シグマくんのお口の中だけを）展開することです。ですから、展開した形をひとまとめにして、総和記号の守備範囲に（シグマくんのお口の中に）もどしてやらないといけません。こんな形になります。 Figure 3.1: 第一段階：2乗を展開 シグマくんこと総和記号の守備範囲は、かっこの終わりまでです。かえって難しくなった気もしますが、こうやって展開しないと、シグマくんの変身術が使えないのです。かっこの中に、引き算記号と足し算記号があります（図の赤い三角形の位置）。ということは、この位置で「分身」できるのです。 3.1.3 第二段階：「分身」させる かっこの中が、足し算記号および引き算記号で３つの項に分かれていましたので、3つのシグマくんに「分身」させます。すると、こうなります。 Figure 3.2: 第二段階：分身 3つに分身した総和記号を、ひとつずつ観察してみましょう。 まずひとつ目、総和記号Aです。総和記号Aは、これ以上何もできません。というより、何もしなくてもいいことがわかっています。どうしてかというと、この形のまま、目的の式に表れているからです（ゴール地点にもどってたしかめてください）。 ということは、二つ目と三つ目、総和記号Bと総和記号Cをなんとか変形して、目的の式の形に近づけていけばいいことになります。より簡単な、総和記号Cから考えましょう。 3.1.4 第三段階：総和記号Cは「エヌ倍」にする 三つ目の総和記号Cに注目してください。中にはいっているのはすべて、\\(\\bar x\\)という同じ数です。データでは62です[*]。つまり平均の二乗です。注目するところは、これに添え字がないことです。ということは、ずっと同じ値ですから、単純に掛け算に書き直してよい、つまり、「エヌ倍」に書き直してよいのでした。書き直してみましょう。 ＊ここで、62を、36としてしまわないのは、最初の式との関連を見失わないようにするためです。ここで2乗しようとしている6は、うすい緑色の背景がつけてあります。もとの式をたどると、6は(1-6)2と使われていることがわかります。つまりデータの平均値です。2乗して36と書き換えてしまうと、このようにもとをたどることが難しくなります。真ん中の項の-2×1×6なども同じ理由で、あえて計算しないままにしています。このほうが、数式との対応を見失わずにすむと思います。 Figure 3.3: 第三段階：エヌ倍 3.1.5 第四段階：総和記号Bは、まず「後がけ」にする 次は二つ目の総和記号Bに注目してください。ここはもともと引き算記号の位置で「分身」したので、先頭に引き算記号がのこっています。書き換えているうちに忘れないようにします。 総和記号Bのなかには、3つの数が入っていますが、添え字のあるもの、つまり出席番号がついているものは、xiだけです。ですから、これ以外の2と\\(\\bar x\\)は、「後がけ」にして、総和記号の前に出すことができます。そうすると、総和記号の守備範囲に残るのはxiだけです。書き直すと、こんな形になります。 Figure 3.4: 第四段階1：後がけ でも、これで終わりではありません。総和記号として残っている一番最後の\\(\\sum_{i=1}^n x_i\\)というところ、見覚えはないでしょうか。これは、第2章「偏差の総和」のところでも解説した、データを合計している計算ですね。そして、データの合計は、平均値のn倍に書きかえられるのでした。というわけで、さらに次のように変形できます。 Figure 3.5: 第四段階2：データの総和は平均のn倍 総和記号が消えたあとの式には、\\(\\bar x\\)が2回出てきます。同じ値を2回掛け合わせている、つまり、二乗しているのですから、右端に書いたように、さらに簡単に整理できます。これで、二つ目もとても簡単な形に書きかえられました。 では、もとの式に戻って、総和記号BとCを、書き換えた後の簡単な形に入れ替えてしまいましょう。 3.1.6 第五段階：変形結果を代入すると 第二段階「分身」が終わったところから、総和記号BとCを変形して、ずいぶん簡単な形に変えることができました。変形結果を、第二段階の式に代入します。 Figure 3.6: 第五段階：変形結果の代入 最後に、第2項と第3項を計算しましょう。これらは、\\(n\\bar x^2\\)が共通ですから、係数の部分を計算してまとめることができます。したがって、 Figure 3.7: 式変形の完成 これで、求めていた形にたどり着くことができました。最初に確認したゴール地点と同じ式になっていることをたしかめてください。 3.1.7 公式の使い道 さて、はじめに確認したように、ここまで変形してきた式は偏差平方和を計算する式でした。分散公式の先頭の\\(\\frac 1n\\)を取り除いた（つまりn倍した）形です。 \\[SS = \\sum_{i=1}^n x_i^2 - n\\bar x^2\\] この式でも、偏差平方和を正しく計算できるかどうか、確かめておきましょう。まず、定義式どおりに計算します。つまり、データから平均値を引いた値（偏差）を2乗して足し合わせます。使うデータはx=(1,4,7,8,10)、平均は6です。 \\[\\begin{aligned} &amp;(1-6)^2+(4-6)^2+(7-6)^2+(8-6)^2+(10-6)^2 \\\\ = &amp;25+4+1+4+16 = 50\\end{aligned}\\] 偏差平方和は50です。次に、変形した式（この節の冒頭）で計算してみましょう。 \\[\\begin{aligned} &amp;(1^2+4^2+7^2+8^2+10^2) - 5 \\times 6^2 \\\\ = &amp;(1+16+49+64+100)-5 \\times 36 \\\\ = &amp;230 - 180 = 50 \\end{aligned}\\] 偏差平方和は50になりました。たしかに、変形後の式でも、正しく偏差平方和を計算できました。この例では、平均値が整数になっていたので、あまり得した感じがないのですが、もし平均値が小数になるような場合には、もうすこし恩恵があるかもしれません。 でも、私たちはこの式をどこかで役立てることができるのでしょうか。 役立ちそうなのは、統計学の試験などで、「分散の近似値としてもっともふさわしい値を選びなさい」のような場面です。分散公式（3.1式）で計算すれば、それは近似値どころか、正確な分散の値です。 ただし、そのほかの場面では、ほぼ役に立ちません。実際にデータを集めて分析を進めるときには、電卓をたたくよりも、分析ツールを使ったほうが速くて正確です。ですから、統計学の試験対策のためだけに、分散公式を覚えたくはありません。無料の統計ツールを使えるようになっている現在、はっきり言って覚える必要のない式なのです。 では、どうしてそんな「覚える必要のない式」について長々と話しているかというと、この式が、私の疑問にヒントをくれるからなのでした。前章の終わりに書いた疑問です。次の節で、その疑問の解明にすすみましょう。 "],["s32_variance_bias.html", "3.2 平均値の移動と偏差平方和の過大評価", " 3.2 平均値の移動と偏差平方和の過大評価 前章の最後に私が出した疑問は、「平均値が小数になったとき、整数に丸めて分散を計算してもいいのか」でした。教科書には、「分散公式を使うとよい」とは書いてありましたが、整数に丸めた平均値を使ってもよいとは書いてありませんでした。 もちろん、平均値が0.2なのか0.3なのかが重要である場面で、整数に丸めようなどとは思いません。心理学の研究では、心理尺度の点数を平均するような研究が多く行われていて、そこでは多くの場合、項目の平均値が3.2とか、複数の項目の合計点の平均値が14.75とか、そのような値になっています。こうした場合に、平均値を丸めて、3.2のかわりに3を、14.75のかわりに15を使って、定義式通りに分散を計算してもいいのだろうか、というのが私の疑問でした。 前節で説明した、分散定義式を分散公式に変形する過程を用いると、この疑問に対する一般的な答えが導けます。そして、その過程の中に、分散分析についての気づきが含まれている、というのが、本書における私の主張です。 ではまず、整数に丸めた平均値を使うと、計算結果はどうなるか、ということから確かめていきましょう。ここでもやはり分散ではなく、nで割る前の値、つまり偏差平方和のままで話をすすめます。 3.2.1 整数に丸めた平均値を使うと 整数に丸めた平均値を使って計算したら、偏差平方和はどんな値になるのか、まず具体的な数値で考えましょう。データは、x=(2,4,7,8,10)、平均値は6.2です。Excelで計算した値を示しました。 左が、正しい平均値（6.2）を使用して計算した偏差平方和で、右が丸めた平均値（6.0）を使用して計算した偏差平方和です。平均値が0.2小さくなった時、平方和は0.2大きくなっています。nで割って分散にすると、前者が8.16、後者が8.2ですから、この程度の差であれば、「分散としてもっとも近い数を次の選択肢から選べ」のような試験問題に、正しく答えられそうです。 平均値と丸めた平均値の差がもう少し大きい場合はどうでしょう。別のデータで、正しい平均値が5.5、丸めた平均値が6のときを考えます。 こんどは平均値が0.5大きくなっていて、平方和は1.0だけ、やはり大きくなっています。nで割って分散にすると、前者が10.25、後者が10.50ですから、やはり極端にずれた値にはならないことがわかります。 3.2.2 計算誤差はどれくらいか 平均値を丸めたことによる計算誤差について、整数に丸めた場合だけでなく、たとえば正しい平均値18.5を20に丸める場合、正しい平均値43を40に丸める場合など、より一般的な場合ではどうなるのか、Excelで実験してみました。 左の表では、平均値を1.5大きくしたら、偏差平方和は13.5大きくなりました。右の表では、平均値を3.0小さくしましたが、やはり偏差平方和は45.0大きくなりました。これらのことから、平均値を丸めても、偏差平方和が小さくなることはなく、必ず大きくなるようです。そして、正しい平均値との差が大きいほど、計算誤差も大きくなります。では、「正しい平均値と丸めた平均値との差」と、偏差平方和の計算誤差との間に、どんな関係があるのでしょうか。 私は次のように考えてみました。丸めた平均値を使ったとき、偏差平方和は誤った値になります。この「誤った偏差平方和」は、次の式で計算できます。 そして、「丸めた平均値」は、正しい平均値に「丸め誤差」を加えた値といえるので（つまり、「丸めた平均値＝平均値＋丸め誤差」と書けるので）、2行目ではこれを代入しています。 計算誤差を求めるためには、「誤った偏差平方和」から、正しい平均値をつかった「正しい偏差平方和」を引いてやればよいので、結局、次の式を解けばよいことになります。 この式の中の「データ」、「正しい平均値」などをそれぞれ記号に置きかえると、下の数式が得られます。数式の中のeは、「丸め誤差」です。この節の最初の例では、正しい平均値が6.2、丸めた平均値が6.0でしたから、e=6.0-6.2=-0.2と考えているわけです。 \\[ SS_e = \\sum_{i=1}^n \\{x_i - ( \\bar x + e)\\}^2 - SS \\qquad \\cdots \\cdots \\mathrm{(3.3)} \\] しかし、こんな数式、教科書にはのっていません。本当に、ちゃんとわかりやすい答えが出せるのでしょうか。 3.2.3 第一段階：中カッコの中を整理して展開する では、順に計算式を整理していきましょう。最初に、式の前半の、中かっこの部分だけを整理します。中かっこの内側だけを取り出して整理します。 \\[x_i - ( \\bar x + e) = x_i - \\bar x - e\\] かっこを外すと右辺のようになります。3つの項がありますが、最初の2つの項\\(x_i - \\bar x\\)は、これまでもよく見てきた形ですね。これはデータから平均値を引いているので、偏差です。偏差の合計は0になる、という便利な性質をすでに私たちは知っていますから、どこかでこの性質が使えたらうれしいですね。この\\(x_i - \\bar x\\)の形を、つねに「ひとまとまり」だと考えて、つまり、この形をくずすような変形をしないように気をつけて、進めていきましょう。「ひとまとまり」を数式で表現するために、\\(x_i - \\bar x\\)をかっこでくくります。 \\[x_i - ( \\bar x + e) = x_i - \\bar x - e = (x_i - \\bar x) - e\\] これをもとの式の中かっこの中に戻すと、次の形になります。相変わらずかっこが二重になっていますが、青い文字で示した内側の小かっこは「ひとまとまり」であることを忘れないように式変形をしていきましょう。 Figure 3.8: 第一段階：中かっこの中を整理 3.2.4 第二段階：二乗の展開と「分身」 つぎに、分散の定義式を変形したときと同じように、二乗の計算を展開します。繰り返しますが、青い文字で示した内側の小かっこは「ひとまとまり」ですから、あたかもひとつの数字や文字であるようにあつかいます。 Figure 3.9: 第二段階1：二乗の式を展開 このようにすると、総和記号を、足し算引き算記号の位置、つまり赤い三角形の位置で「分身」させることができます。[*]ここはもう何度も通った道ですね。３つの総和記号に「分身」させます。 2つめの赤い三角形の右にある0.22は、正しくは(-0.2)2と書くべきですが、字が小さくなりすぎて見づらくなるので、このようにしています。2乗していますから、計算結果に影響はありません。 Figure 3.10: 第二段階2：分身 3.2.5 第三段階：「エヌ倍」 ３つに分かれた総和記号のうち、三つ目の総和記号Cは、「エヌ倍」に変身できます。e2には出席番号がついていませんから、掛け算に直せます。総和記号Cを「エヌ倍」に変身させましょう。これで総和記号がひとつ消えました。 Figure 3.11: 第三段階：エヌ倍 3.2.6 第四段階：「後がけ」 二つ目の総和記号Bは、「後がけ」が使えます。青い文字の\\(x_i - \\bar x\\)は出席番号がついています。ここは「ひとまとまり」にして扱うと決めましたから、さわらずにおきます。ですが、それ以外の部分、2とeは「後がけ」できますから、まとめて総和記号の前に出してしまいましょう。 Figure 3.12: 第四段階1：後がけ さらに、ここに残っている総和記号が何を計算しているかを見てみましょう。データから平均値を引いたものを合計しています。つまり偏差の合計です。偏差の合計は0になることを、私たちはすでに知っています。ということは、この総和記号は、0に置き換えることができます。これで、総和記号がもうひとつ消えました。 Figure 3.13: 第四段階2：偏差の総和は0 3.2.7 第五段階：まとめ 残ったのはひとつ目の総和記号Aです。これは、すでに見た形ですね。そうです、偏差平方和を計算する式と全く同じです。ですから、偏差平方和を意味する記号、SSに置き換えることができます。まとめると、3つに「分身」した総和記号たちは、それぞれ次のように形を変えました。 総和記号Cは、「エヌ倍」してne2に。 総和記号Bは、偏差の総和が0になるので、結局0に。 総和記号Aは、偏差平方和の計算式と同じなので、SSに。 Figure 3.14: 式変形の完成 みごとに、式の変形が完成しました。びっくりするほど簡単な形になりましたね。残ったのは3つ目の項、ne2です。 この式が何を計算していたかを、復習しましょう。丸めた平均値をもちいて偏差平方和や分散を計算するときの、計算誤差を考えていたのでした。正しい平均値との丸めた平均値とのずれ、つまり丸め誤差ををeと表し、偏差平方和の計算誤差をSSeとして式に表し、それを整理してきたのでした。結果はすでに見たとおり、 \\[SS_e = ne^2\\] となりました。つまり、次のことが分かったのです。 丸めた平均値をつかって偏差平方和を計算すると、正しい平均値をもちいて計算したときよりも少し大きい値が得られる。どれくらい大きい値になるかは、「正しい平均値と丸めた平均値とのずれ＝丸め誤差」から計算できる。丸め誤差をeとあらわすと、ne2だけ、偏差平方和は（正しく計算した値よりも）必ず大きくなる。 実験で明らかになったように、丸めた平均値をつかって計算した偏差平方和は、正しい平均値をつかって計算した偏差平方和よりも、必ず大きくなりました。これは、丸め誤差の2乗のn倍が、偏差平方和の計算誤差として現われていたからでした。 "],["s33_my_question.html", "3.3 平均値は偏差平方和を最小にする値", " 3.3 平均値は偏差平方和を最小にする値 本章の議論をまとめましょう。 前章の最後に、丸めた平均値を使って分散を計算してもよいのだろうか、という、かつて私が抱いた疑問について書きました。これを解決するために、まず分散の定義式を分散公式に変形する方法について解説しました。ただし、実際には分散ではなく、nで割る前の、偏差平方和を求める式で行いました。 そのときの式変形をもとにして、丸めた平均値を使うと、偏差平方和が、正しい偏差平方和よりも常に大きい値になること、具体的には、「丸め誤差の2乗のn倍」だけ大きくなることを明らかにしました。この仕組みを理解していれば、丸めた平均値で偏差平方和を計算したあとで、正しい偏差平方和を求めることができ、結果的に正しい分散を求めることも可能です（もちろん、統計ソフトを使っているのなら、そんな面倒なことをする必要はありません）。 このことは、平均値についての重要な性質を明らかにしています。すなわち、「平均値は、偏差平方和を最小にする値である」という性質です。どういうことでしょうか。 3.3.1 偏差平方和を最小にする定数を求める 丸めた平均値、つまり、正しい平均値からずれた値をつかうと、偏差平方和はかならず大きくなるのですから、正しい平均値をつかったときに、偏差平方和がもっとも小さくなることは明らかです。本節では、このことを数式を使って証明しておきたいと思います。微分を使いますので、苦手な方はこの節をとばしてください。この証明がわからなくても、何の問題もありません。 偏差平方和をSS、偏差平方和を最小にする定数をCとおくと、SSは次のように表すことができます。 \\[SS = \\sum_{i=1}^n (x_i - C)^2\\] これを展開します。二乗の計算を展開したあと、「分身」と「エヌ倍」と「後がけ」をつかっています。 \\[SS = \\sum_{i=1}^n (x_i^2 - 2x_iC + C^2) = \\sum_{i=1}^n x_i^2 - 2C\\sum_{i=1}^nx_i + nC^2\\] この式の最右辺を、Cについての2次方程式とみて、次のように書き直します。2次方程式ですから、Cを横軸にとると、放物線のグラフが描けます。そして、グラフがいちばん凹んでいるところが、この式が表している偏差平方和の最小値であり、そのときCの値を、ここで求めたいのです。 \\[nC^2 - 2C\\sum_{i=1}^nx_i + \\sum_{i=1}^n x_i^2\\] この式をCについて微分し、微分した式の値が0であるとします。微分の練習問題に比べると、じゃまなものが多くて混乱しそうです。が、第3項にはCが入っていないただの定数ですから、微分したら0です。第1項は(x2)’=2xという、見慣れた公式で微分できますね。微分するとこうなります。 \\[2nC - 2\\sum_{i=1}^n x_i = 0\\] 微分した式が0になるような、Cの値を探します。右辺に「=0」をつけて、式変形をして、最終的に「C=」の形にします。そうすると、何が分かるかというと、放物線のいちばん凹んでいるところのCの値です。ここからは一次方程式ですので、比較的簡単でしょう。 \\[\\begin{aligned} 2nC - 2\\sum_{i=1}^n x_i &amp;= 0 \\\\ nC &amp;= \\sum_{i=1}^n x_i \\\\ nC &amp;= n\\bar x \\\\ C &amp;= \\bar x \\end{aligned}\\] 途中で、「データの総和は平均値のn倍」という、これまでに何度ももちいた変形技を使っています。最終的に、C=\\(\\bar x\\)という式が導かれました。これは、Cがxの平均値のとき、最初の式の値が最小になることを示しています。よって、偏差平方和を最小にする定数は、データの平均値であることがわかります。 3.3.2 分散分析との関係は 本章のはじめのほうで、私こう書きました。 前節で説明した、分散定義式を分散公式に変形する過程を用いると、この疑問に対する一般的な答えが導けます。そして、その過程の中に、分散分析についての気づきが含まれている、というのが、本書における私の主張です。 「この疑問に対する一般的な答え」は、ここまでで見てきたとおりです。偏差平方和の計算誤差はne2であることが明らかになりました。では、ここまでの過程の中に、分散分析についてのどんな気づきが含まれているのでしょうか。すでにお気づきの読者もおられると思いますが、本書の後半では、このことを考えていきます。 が、その前に、推測統計や統計的仮説検定について、少々解説します。なぜかというと、分散分析の話をするには、自由度について話すことが必要ですが、自由度について話すには、推測統計の話をしなくてはならないからです。このあたりのことについて、もう十分に知っている方は、次章をとばして、分散分析の話にすすんでください。推測統計について復習したい方は、どうぞお付き合いください。 "],["c4_statictest.html", "4 統計的仮説検定についてのあれこれ", " 4 統計的仮説検定についてのあれこれ 本書の後半では、分散分析についてお話ししていきます。それに先立って本章では、分散分析の理解にどうしても必要である、推測統計および統計的仮説検定（帰無仮説検定）についてお話しします。ただし、次章の分散分析の話に必要な部分の解説にとどめ、包括的な説明や理論的な説明にはふみこみません。具体的な設定をもとに、きわめてざっくりとした説明を行いますので、厳密さに欠ける部分があることをご了解ください。 "],["s41_setting.html", "4.1 設定", " 4.1 設定 本章以降の解説のために、次のような調査が行われたことにします。調査内容や結果はすべて架空のもので、実際に行われたどの調査とも、いっさい関連はありません。また、本書でこれらの結果すべてについて扱うわけではありません。 設定 放送大学の学生Aさんは、学習センターでさまざまな年代の学生たちに出会って気づいたことがあります。学習センターでよく出会う学生たちは、サークルで友だちになった学生どうし助け合って試験に受かったこと、わからなかったことを聞いてみたら初対面の学生がていねいに教えてくれたことなど、学習することの楽しさを感じているようでした。 一方で、講義を聞くのは楽しかったけど、試験は難しくて単位を落としてしまった、試験には受かったけど、ちっとも身についていないようだ、など、学習成績にはかならずしも満足できなかったと話す学生もいました。 そこで、放送大学で学ぶ学生に対して、放送大学での「楽しさ」と、「達成感」を調査し、どの程度関連しているか、また、それらが、サークル活動に参加しているか否かで異なるのかを調べようと思い立ちました。 使用した質問は下記のものです。調査は、Aさんが所属する学習センターで開催された面接授業に参加した学生を対象に行いました。講義の休憩時間中に、Aさん自身が、調査への協力をよびかけました。調査への参加は任意であり、参加するか否かは授業成績に影響しないことを説明し、廊下に掲示した二次元コードを利用して回答フォームにアクセスして回答するよう案内したところ、回答締切である面接授業終了日の24時までに30名から回答が得られました。 質問内容 問1：放送大学で学ぶことや、学んでいる科目に、どのくらい楽しさを感じていますか。「学習は最高に楽しい」を10点、「学習はまったく楽しくない」を0点として点数をつけてください。 問2：放送大学での学習のできばえや成績について、どのくらい達成感を感じていますか。「十分な達成感がある」を10点、「達成感は全くない」を0点として点数をつけてください。 問3：あなたは、放送大学の学生団体（サークル、クラス会など。非公認のものは含まない）に1つ以上所属していますか。はい／いいえで答えてください。 問4：あなたは、学習センターのある市（県庁所在地である○○市）内に住んでいますか。 くり返しますが、問題の設定や調査の計画、回答データはすべて架空のものです。質問紙による調査として、ここに示した方法にはどんな問題があるでしょうか。質問紙（実際には回答フォームを使用）には、質問以外にどんな情報を示したり、どんな情報を追加で収集したりする必要があるでしょうか。心理学研究法の演習課題として、取り組んでみてください。 "],["s42_infer_stat.html", "4.2 推測統計と推定・検定", " 4.2 推測統計と推定・検定 4.2.1 母集団と標本 最初に、母集団と標本について確認しましょう。 「標本（サンプル）」は、実際に調査に回答してくれた人々（から得られたデータ）です。「30名から回答が得られました」と記されていますから、この30名（のデータ）が標本です。 「母集団」は、できればその全員に対して調査をしたい集団のことです。設定の本文中にはあいまいにしか書かれていませんが、ここでは「放送大学で学ぶ学生」（約8万人）を母集団と考えておきます[*]。Aさんは、母集団のこと、つまり放送大学で学ぶ学生全員について知りたいのですが、全員に対して調査をすることは難しいので、標本調査をして、そに結果をもとに、母集団ではどうなのだろうと推測することにしたのです。 ＊放送大学教養学部の在籍者数は、約8万人前後で推移しています。詳しくは次のサイトをご覧ください。https://www.ouj.ac.jp/about/ouj/number/ 4.2.2 記述統計 では、データを見ていきましょう。繰り返しますが、架空のデータです。本書では、問2と問3のみを扱います。 まず、「問2：放送大学での学習のできばえや成績について、どのくらい達成感を感じていますか」についてです。以下、この質問に対する回答データを「達成感」と表すことにします。「達成感」は、「学習は最高に楽しい」を10点、「学習はまったく楽しくない」を0点として、学生が自分自身の達成感を数値化したもので、今回の調査（n=30）では、「達成感」の平均値は7.00、標準偏差は約1.32でした。 つぎに、「問3：あなたは、放送大学の学生団体（サークル、クラス会など。非公認のものは含まない）に1つ以上所属していますか」についてです。以下「サークル所属」と表すことにします。「サークル所属」は「はい／いいえ」のどちらかを選んでもらいました。今回の調査（n=30）では、「はい」が15名、「いいえ」が15名で、「サークル所属」の割合は0.5(50％)でした。 4.2.3 推測統計 これらの結果をもとに、母集団ではどうなのかを推測するのが推測統計でした。もっとも単純な推測統計は、標本から得られた平均値や割合を、そのまま母集団の平均値や割合だとする方法です。つまり、 標本（n=30）での「達成感」平均値は7.00だったので、母集団（放送大学の全学生）での「達成感」の平均値も7.00と推測できる。 標本（n=30）での「サークル所属」比率は0.5だったので、母集団（放送大学の全学生）での「サークル所属」比率も0.5と推測できる[*]。 「推測統計」と名前がついているのだから、もっといろいろな手続きをふんでいるのかと思いきや、こんなのでいいのか、と思ってしまいますね。ここで行っていることは、標本統計量をそのまま母数の推定値として使う、という方法です。こんな簡単なことでいいなら、誰でもできそうですが、残念ながら、推測統計はここで終わるのではなく、ここが出発点だといっていいと思います。どういうことでしょうか。まず、当然のことをひとつ、確かめておきましょう。 ＊ここでは、「比率」と「割合」は同じ意味であるととらえてください。厳密には、割合は「全体に対する部分の大きさを表す数値」です。全体を1と考えるので、割合は0～1の範囲の値をとります。比率は「2つ以上の数量を比較した数値」です。「今年度売り上げは昨年度の1.2倍だった」のように1より大きい値もとり得ます。本文で算出している「サークル所属」は、全体のうち何人がサークルに所属しているかを表す値ですから、「割合」と適切かと思いますが、統計の用語で「標本割合」「母割合」ではなく「標本比率」「母比率」という語が一般的に使われるので、「比率」を使用しています。 4.2.4 標本統計量は母数と一致しない 標本のデータをもとに計算する値のことを「標本統計量」といいます。さきほどの「達成感」平均値は、n=30の標本から計算した平均値なので、「標本平均」です。「サークル所属」比率は、やはりn=30の標本から計算した比率なので、「標本比率」です。これに対して、母集団全員を調べて計算したらこうなるだろう、という値を、それぞれ「母平均」、「母比率」などといい、これらを総称して「母数」といいます。 大前提として、標本統計量は、母数と一致しません（たまたま、偶然に、奇跡のように一致してしまうことが「絶対にない」とまでは言っていません）。なぜかというと、しょせん母集団のごく一部のデータしか見ていないのですから、ぴったり一致するほうが奇跡です[*]。 ＊標本平均も標本比率も、標本サイズを大きくすればするほど、母平均や母比率に近い値が出やすくなります。このような性質を「一致性」といいます（小杉,紀ノ定,清水(2023)）。 4.2.5 点推定と区間推定 とはいえ、母数が知りたくて調査や研究をしているわけであって、標本統計量がわかれば満足なのではありません。何らかの手がかりをもとに、母数を推測したいのです。その材料は標本統計量しかありません。標本平均値をもとに母平均を推測する、あるいは、標本比率をもとに母比率を推測するのは当然のことです。ですから、「母平均は標本平均値とだいたい同じだ」というのは、妥当性をもった考え方なのです。この方法、つまり、標本統計量（標本平均、標本比率など）を母数（母平均、母比率など）と見なす、という推定方法を「点推定」といいます。 しかし、点推定はかならず間違えます。標本平均が母平均とぴったり一致しないのもまた、統計学の常識だからです。そこで、「母平均は標本平均とだいたい同じ」というふわっとした表現ではなく、標本平均値をもとにある範囲を計算し、「母平均はこの範囲の中にありそうだ」と推測するのです。これを「区間推定」といいます。そして、この「区間」を計算するためには、偏差平方和と自由度の理解が必要です。母数が存在しそうな区間を計算する「区間推定」は、推測統計の有力な方法のひとつです[*]。 ＊小杉,紀ノ定,清水(2023)では、ぴったり一致しなくても、ある程度近い値なら点推定が成功したことにすればよいのではないか？をシミュレーションすることから、区間推定の説明へとつなげています。たいへん面白く、わかりやすい導入方法だと思います。 このような「推定」とは別に、母数は少なくともこの値ではない、母集団を何らかの方法で2つに分けたとき、それぞれ母数は明らかに異なっているようだ、という確率的な判断をする方法もあります。これが「統計的仮説検定」です。分散分析は、後者の判断のための方法です。本書の設定にあわせて、次節で具体的に話しましょう。 点推定はかならず間違える？ 間違えます、といっていますが、これは、標本統計量がでたらめな値であるとか、まったく的外れな値であるという意味ではありません。「ぴったりと一致するわけではない」という意味です。母平均が6.792であったとしたら、標本平均が6.792になって初めて「点推定が成功した」といえます。標本平均が6.791であっても、6.7923であっても、母平均と等しくない（等号で結ぶことができない）ことに変わりはありません。ものすごく近くて、ものすごく惜しいのですが、数学的には「異なる値」であり、「ぴったり一致」していません。このような意味で「間違えます」を解釈してください。「なんだよ、こんなわずかな差くらい構わないじゃないか」とはならないのですね。だから数学も統計学もきらいなんだよ、とか言われそうですが。 点推定ではなく区間推定を行うためには、ここから、(1)偏差平方和と自由度をもちいて、「標準誤差」という統計量を算出すること、(2)標本統計量がしたがうと考えられる分布を特定して、計算に必要な「分布の幅」を特定することなどが必要です。これらの理解には、確率分布に関する知識が必須ですが、本書ではここの部分を扱いません。別の教科書（参考資料参照）で勉強してください。 4.2.6 統計的仮説検定 標本（n=30）での「達成感」平均値は7.00でしたが、標本を「サークル所属」しているかしていないかに分けて平均値を計算すると、サークル所属していないグループ（n=15）では、「達成感」平均値は6.60、サークル所属しているグループ（n=15）では、7.40でした。ここまでは記述統計です。サークル所属しているグループのほうが少し達成感が高いという結果でした。 では、母集団全体を、サークル所属しているかどうかで2つのグループに分けたうえで、「達成感」の平均値を計算したとしたら、やはり「サークル所属しているグループのほうが少し達成感が高い」という結果になるのでしょうか。つまり、母集団を2つのグループに分けたときに、平均値に差があるといえるのでしょうか。 母集団全員に対して調査をすることは不可能ですから、標本データをもとに、上記の問いに対して「差があると言えそうだ」あるいは「差があるとは言い切れない」という確率的な判断をしたいのです。そのためのツールが「統計的仮説検定」です。 判断のためには、「検定統計量」という数値を計算する必要があります。そのためには、標本平均だけではなく、偏差平方和と自由度について知る必要があり、それらを用いて検定統計量を計算する必要があるのです。本書で解説する「分散分析」では、「F比（F値）」という検定統計量を計算して、それをもとに確率的な判断をします。偏差平方和の計算についてはこれまでに解説してきましたから、ここでは自由度について解説します。自由度を理解すると、分散分析ができるようになります[*]。 ＊本書で解説するのは、分散分析のもっとも簡単な形である、一要因分散分析（一元配置分散分析ともいう）です。また、説明を簡単にするために、2つのグループの平均値の比較を行います。通常、2つのグループの平均値の比較にはt検定という方法を使いますが、本書では分散分析をもちいます。なぜかというと、「はじめに」で提示して第3章で解き明かした私の疑問が、分散分析の理解を助けるヒントになっていると考えているからです。 "],["s43_degree_freedom.html", "4.3 自由度とは", " 4.3 自由度とは はじめに「自由度」とは何かを定義しておきます。ここでは、基本的には次の説明を採用することにします。 自由度とは、母数を推定・検定するときに、母集団から抽出された標本に含まれる各個体の値のうち、自由にとることのできる余地のある値の数（一意に定まらない値の数）を指す。（林(2024),p.86） たとえば、データが2個しかない時、1つのデータの値を「自由に」決めてしまえば、もう1つのデータの値は自動的に決まってしまいます。なぜ自動的に決まるかというと、データの平均値はすでに計算されていて、偏差の合計は0になるはずだからです。データが10個あるとき、9個までは自由に決められますが、最後の1個は自動的に決まってしまいます。最後の1個まで自由に決めてしまうと、データの平均値が変わってしまうからです。 このように考えると、自由度はふつう、データ数より1小さい数であると考えることができます。 4.3.1 二種類の分散 自由度について知るために、「二種類の分散」についてお話しします。二種類とは、偏差平方和を、nで割った分散と、偏差平方和を(n-1)で割った分散です[*]。なぜ割る数が違うかというと、使う目的が違うからです。誤解を恐れずざっくり書くと、 nで割った分散は、記述統計のために使います。標本データの散布度をあらわす統計量の一つです。 (n-1)で割った分散は、推測統計のために使います。標本データの散布度をあらわす統計量の一つでもあるし、母集団の分散（母分散）の推定値でもあります。 違うのは、母分散の推定、つまり、母集団の分散はこれくらいかなあ、という具体的な予測値として使うかどうか、ということです。では、この二種類の分散は、具体的にどのくらい違うのでしょうか。また、なぜ(1)の分散は推測統計のためには使わないのでしょうか。 当然ですが、偏差平方和をnで割るよりも、(n-1)で割ったほうが、少しだけ大きくなります。偏差平方和が90で、標本サイズが10だったとすると、前者（nで割る）では90÷10=9ですが、後者（(n-1)で割る）では90÷(10-1)=90÷9=10です。 つまり、母分散の推定値として使うときには、nで割るのではなく、(n-1)で割って、少し大きめの値にするほうがいい、ということなのです。（同じことを母分散の立場から書くと、nで割った値は、母分散の推定値としては、わずかに小さすぎる、ということです。多くの教科書はこちらの立場で書かれているので戸惑うかもしれませんが、「nで割った分散＜(n-1)で割った分散」という大小関係だけしっかり理解してください。） そして、本書で説明してきたことを使うと、偏差平方和を(n-1)で割って、少し大きめの値にした方が、母分散には近い値になりやすいことがわかると思います。なぜなら、すでに説明したように、標本平均は、母平均と一致しないからです。どういうことでしょうか。 ＊Excelの関数では、前者がvar.p関数、後者がvar.s関数です。RやHADでは、デフォルトで後者の分散を出力します。 4.3.2 母分散は標本分散より常に大きい？ 本書の第3章で、平均値を丸めて計算したら、偏差平方和はどうなるのかについて、分散定義式を分散公式に書き換える過程をもちいて解説しました。その結果、「正しい平均値と丸めた平均値との差（丸め誤差）」の2乗をn倍した分だけ、偏差平方和はかならず大きく計算されることがわかりました。 このことを、母分散の推定に応用してみましょう。 標本から得られたデータをもとに、標本平均が計算されました。標本平均を使って偏差平方和（およびそれをnで割った分散）も計算されました。しかし、標本平均と母平均は一致しません。ですから当然、分散も母分散とは一致しません。 このとき、標本平均は、母平均から「どちらの方向へ」「どのくらい」ずれているのか（つまり、母平均は標本平均より大きいのか小さいのか、その差はどれくらいなのか）は、永遠にわかりません。ただし、分散についてはそうではありません。母分散は、標本から計算した分散（nで割ったほうの分散）よりも、「（わずかだけれど）必ず大きい」と考えるほうが妥当性が高いのです[*]。どうしてかというと、標本平均は母平均とぴったり同じ値ではないからです。 もし、標本データの偏差平方和を計算するときに、標本平均値を使うのではなく、母平均を使ったら、偏差平方和の値はどうなるでしょう。「母平均」のところを「丸めた平均値」と読み替えると、第3章の議論がそのままあてはまることがわかると思います。標本平均値（正しい平均値）のかわりに「丸めた平均値」をつかったとき、偏差平方和は、「丸め誤差＝正しい平均値と丸めた平均値との差」の2乗のn倍だけ、必ず大きくなりました。これと同じことが、ここでおきているのです。すなわち、標本平均値のかわりに「母平均」をつかったとき、偏差平方和は、「標本平均値と母平均との差」の2乗のn倍だけ、かならず大きくなるはずなのです。よって、分散を求めるときに、偏差平方和をnで割るのではなく、(n-1)で割って少しだけ大きな値にした方が、母分散（つまり母平均を使って計算した分散）の推定値としては妥当性が高いだろう、と考えているのです。 ＊繰り返しになりますが、たとえ(n-1)で割って分散を求めたとしても、その計算結果が母分散とぴたりと一致するわけではありません。標本から計算した統計量が母数と一致しないのは、分散についても同じです。もう少し正確に書くと(n-1)で割った分散の「期待値」（数式で表される理論的な値）が母分散と一致するのです。「期待値」について詳しく知りたい方は、巻末に示した参考図書などをお読みください。 しかし、わたしたちは母平均を永遠に知ることができないように、母分散も永遠に知ることができません。手元で計算された分散（nで割った）が、ほんとうに母分散よりちょっとだけ小さいのかも、永遠にわかりません。ただ、理論的に考えると、(n-1)で割ったほうが、母分散により近い値が計算されやすい、という話です。 4.3.3 使ってもらえないデータの立場 話を少し戻して、nで割るか、(n-1)で割るかについてもう少し考えましょう。標本データはn個あるのですから、分散を求めるときにもnで割るのがごく自然な考え方です。それをあえて(n-1)で割るのはやはり不自然なのです。せっかくn個集まったデータの中の、ある1個のデータに対して、「あ、ごめん。君は今回、計算の仲間に入れないから」って言っているようなものですね。「仲間に入れない」って言われたデータの立場にもなってみましょう。かわいそうです。 でも、あえて「数に入れない」って言っているのは、それなりに理由もあるのです。少々ややこしい話になるので、x=(2,6,7)というn=3のデータで考えましょう。 平均を計算するときには、3つのデータが全部必要です。当然ですね。(2+6+7)÷3=5です。さて、問題は分散を計算するときです。 \\[s^2 = \\{ (2-5)^2+(6-5)^2+(7-5)^2 \\} \\div 3\\] いや、ちゃんと3つとも必要だ、と思いきや「ちょっと待って…」と言いだすのは、実は平均値の\\(\\bar x\\)くんです。「ちょっと待って。3つのうち、どれでもいいんだけど、たとえば7くん。7くんがこの式にいなくなっても、分散は計算できる。だってぼくがいるから」とか言いだすのです。どういうことでしょう。 平均値\\(\\bar x\\)くんのはなし ぼく（平均値\\(\\bar x\\)）を計算するときには、(2+6+7)÷3=5てやったよね。これを変形すると、たとえば、7=5×3-2-6と書けるよね。だから、さっきの分散の計算式の7のところを、(5×3-2-6)で置きかえても答えは同じになるんだ。 実際、置きかえてみると、こうなります。 \\[\\displaystyle s^2 = \\Big\\{ \\Big(2-5\\Big)^2+\\Big(6-5\\Big)^2+\\Big( (5 \\times 3 - 2 - 6) -5\\Big)^2 \\Big\\} \\div 3\\] かっこが多すぎてとっても見づらいのですが、たしかに7がなくても分散を計算する式が書けてしまいます。 平均値\\(\\bar x\\)くんのはなし～つづき ということは、ぼくたちって、データは確かに3つあるんだけど、「分散を計算するとき」に限っては、「実は2つ分のデータしかない」みたいに見えてるんじゃないの？ さっきは勝手に7くんをなくしちゃったけど、2くんをなくしたって、6くんをなくしたって、同じように式が書ける。だから、どれを選んでもいいけど、2個だけ自由にデータを選んでくれば、分散は計算できるんだ。ぼく（\\(\\bar x\\)）がいれば、という条件だけどね。あ。ぼく、もしかして、あとから来たのに、いじめっ子みたいになってない？ 大丈夫かな…。 4.3.4 表を書いて確かめよう くどいようですが、平均値\\(\\bar x\\)くんの言っていることを、表を書いて確かめましょう。 たしかに、3つのデータのうちどの2個を選んでも、平均値の情報があれば、隠された値は計算できてしまいます。なぜかというと、平均値のなかに、すでに「選ばれなかった1個のデータ」の情報も入っているからです。まとめると、 すでに「平均値」という情報があるのだから、もとのデータは、(n-1)個あれば十分。どの値を計算に使ってもかまわないけど、任意に(n-1)個を選べば十分。 となります。そして、この(n-1)のことを「自由度」といいます。「この個数までは、分散の計算に使う値を自由に選んできていい。どれを選んでもよくて、重要なのはその個数」なのです。 4.3.5 自由度で割る ここまで、自由度について話してきました。次章からいよいよ分散分析の話に入ります。ここから先は、「偏差平方和」に加えて「分散」という語を使っていきます。ただし、nで割った値ではなく、自由度で割った値のほうです。 (n-1)で割る、と書かないのは理由があります。単純にデータの分散を計算するときには、自由度は(n-1)になります。その過程は上でお話ししました。ところが、分散分析の計算過程では、データを分割してそれぞれについて自由度を考えたり、データを分割するという操作に対して自由度を考えたりする場面が出てきます。また、本書では扱いませんが、二変数の関連を示す指標である相関係数について考える時には、自由度が(n-2)だったりします。自由度はいつでも(n-1)ではないのです。この計算では自由度はいくつなのか、どうしてその値になるのかを考えながら、教科書を読むとよいでしょう。 "],["c5_anova.html", "5 分散分析を分解する", " 5 分散分析を分解する 本章では、分散分析についてお話ししていきます。分散分析は、2つ以上の平均値を比較して、そこに統計的な差があるかどうかを調べる方法です。 第3章で、放送大学の学生を対象に、学習達成の「満足度」などを調べる調査をしたという設定でお話ししました。ここでは、そのデータを、回答者の属性別に分けて検討します。 放送大学には、学習センターに所属する学生で構成されるサークルがいくつかあります。どんなサークルがあるかは学習センターごとに違いますが、外国語を学んだり、一緒に合唱を楽しんだり、パソコンの使い方を教え合ったりなど、さまざまな活動をしています[*]。本章では、回答者の属性として、「サークル所属の有無」をもちいます。そして、サークルに所属している学生と、していない学生とで、放送大学での達成度に対する満足度を比較します。 ＊実際にどのようなサークルがあるかは、各学習センターのホームページをご覧ください。放送大学学習センター一覧：https://www.ouj.ac.jp/about/ouj/center/ "],["s51_about_variance.html", "5.1 分散とは何か", " 5.1 分散とは何か 分散分析の話に入る前に、そもそも分散とは何かについて、整理しておきましょう。分散の意味を表すのに、データの「ばらつき具合」あるいは「散らばり具合」という言い方がよく使われます。データがばらばらな値をとるとき、つまり、数直線のあちこちに散らばっているとき、ばらつきが大きいといい、分散の値は大きくなります。逆に、データがよく似た値をとるとき、つまり、数直線のある範囲に集まっているときに、ばらつきは小さいといい、分散の値は小さくなります。こういう場合には、ばらつき具合というより、密集度といったほうがわかりやすいかもしれません[*]。 ＊「数値シミュレーションで読み解く統計のしくみ」（小杉ほか(2023),p.204）では、分散を「標本平均の近くに密集している程度（すなわち標本平均まわりの散布度）」と説明しています。 分散や標準偏差（分散の正の平方根）のようなばらつきの指標がもちいられるのは、ばらつきのないデータというのは現実的には存在しないからです。買ったばかりの鉛筆でも、1ダースの中にわずかな長さの違いがあるのが普通です。パック入りのミニトマトも一つひとつを比べると大小があり、重さにして数グラムの幅があります。これらは、つくり出そうとして生まれた差ではなく、「やむを得ず生じてしまった」差であると考えられます。分散が表そうとしているのは、このような「やむを得ず生じてしまった」データのばらつきであり、「個体差」あるいは「個人差」としかとらえようのないばらつきだと考えられます[*]。 ＊ただし、分散は2乗の計算が入っていますから、もとのデータと単位が異なります。鉛筆の長さの場合はセンチメートル2乗、ミニトマトの重さの場合はグラム2乗が、分散の単位です。しかしこれでは意味が分かりにくいので、平方根をとって単位をデータと同じものにします。これが標準偏差という指標です。 逆に考えると、「生じてしまった」ばらつきではないもの、「個体差」や「個人差」ではなく、「何らかの外的な要因によって生じている」ばらつきが、分散のなかに混ざっていることもあります。たとえば、次のような設定を考えてみましょう。 子どもを10人集めて身長を測り、平均値と分散を計算しました。平均が131㎝、分散は243でした。しかし、よく聞いてみると10人のうち5人は1年生、残り5人は6年生とのことでした。1年生と6年生を別々にして計算してみると、1年生は平均が117㎝で分散は約25（標準偏差は約5cm）、6年生は平均が145.6cmで分散は約53（標準偏差は約7.2cm）でした。 最初に計算した分散がとても大きな値になってしまったのは、1年生と6年生をいっしょにして分散を計算してしまったからにほかなりません[*]。つまり、「個人差」以外の要因、ここでは「年齢による身長の差」が、データのばらつきを無駄に大きくしていたのです。6年生の子どもたちが、1年生だったときの身長を使って計算すれば、分散はもっと小さくなっていたはずです。 ＊最初に計算した分散の値（約243）を、「とても大きな値」と言っていますが、分散の値の大きさを客観的に評価する基準はありません。ただし、子どもの身長のように、全国的な調査が行われていて、年度ごとに、年齢ごとの平均値や標準偏差が示されている場合には、それと比較することで、分散が大きすぎるのではないかと考えることは可能です。令和3年度の調査によると、身長の標準偏差は、小学校1年生から6年生にかけて、約5から約7まで、年齢とともに大きくなります。発育とともに個人差が大きくなるのですね。しかし、分散が243、つまり標準偏差が約15というのは、全国統計とくらべても大きすぎます。くわしい統計結果は、文部科学省「学校保健統計調査-結果の概要」https://www.mext.go.jp/b_menu/toukei/chousa05/hoken/kekka/1268813.htm などからご覧になれます。 分散を無駄に大きくしてしまっている要因は何かに注目し、その要因の影響を、計算上で取り除いてみる、というのが、分散分析のもとにある考え方です。もしその要因を調整することが可能なら、よりよい結果がもたらされるように要因を調整すべきでしょう。たとえば、使用する教材の違いが、学力の分散を無駄に大きくしているのなら、より学力を伸ばすことができる教材を使うように調整することが学習者のためになります。労働環境の違いが、主観的なストレスの感じ方の分散を無駄に大きくしているのなら、より主観的なストレスを感じにくい環境を導入することで、全体の労働生産性をあげられるはずです。 研究結果が示すこと データを用いた研究が貢献できるのは、あくまでも「平均値」のレベルであることに注意が必要です。本文の例のように、研究の結果、学力の分散を無駄に大きくしているのが、教材Aと教材Bの違い以外に考えられず、しかも、教材Aのほうが、学力の平均値が明らかに高いことがわかったとき、研究成果としては、教材Aのほうが学習者の力を伸ばすことができる、というまとめがなされると思われます。しかし、ここで結論されていることはあくまでも平均値レベルでのことです。どういうことかというと、もともと教材Bで学習していた学習者の中には、教材Aが合わない、好きになれない学習者がいる可能性がありますし、教材Aで学習していた学習者の中にも、教材Aが合わないと感じていた学習者がいた可能性がある、ということです。データは嘘をつきませんが、人々がかならずデータ通りに動くとは限りません。全員が教材Aで学習することで、学力の分散は小さくなるかもしれませんが、だからといって、学習者の「個人差」をなくすことまでできるわけではないし、教材に対する個人的な「合う、合わない」や「好き、嫌い」を変えることはできません。労働環境の例についても同じです。 "],["s52_hypothesis.html", "5.2 サークル所属と満足度の関係", " 5.2 サークル所属と満足度の関係 ここからは、実際に分散分析を行うための計算をしていきます。設定を確認して、仮説をたてておきましょう。 設定では、放送大学での学習の「達成感」が、サークル活動に参加しているか否かで異なるのかどうかを考えていました。サークル活動で学生同士の教え合い、助け合いを嬉しそうに語っている学生がいることから、サークル活動に参加している学生の方が、達成感が高いだろうと予想しておきます[*]。 ＊この設定のように、2つの群のあいだで平均値を比較する分析では、t検定をもちいるのがふつうです。本書では、「分散公式を読み解く」で解説した内容を活かすために、あえて分散分析の枠組みをもちいます。どちらの検定をつかっても、検定結果は同じになります。 5.2.1 帰無仮説と対立仮説 帰無仮説は、2つのグループで結果が全く同じであるという考え方を指すものでした。上記の設定では、学生を、サークル所属している群としていない群に分けて、満足感を比較しようとしています。ですから、「サークル所属していても、していなくても、満足感の平均値は全く同じである（満足感の平均値に差は全くない）」というのが帰無仮説です。 対立仮説は、帰無仮説を単純に否定する形で書きますから、「サークル所属している学生と、していない学生では、満足感の平均値は異なる（満足感の平均値に差がある）」となります。この段階で、どちらのほうが平均値が高い、のように書きたくなるかもしれません。が、たとえば「A群の方が高い」と仮説を書くとするなら、「B群の方が高くなることはありえない」あるいは、「B群の方が高くなっても、自分が主張したいことにまったく影響しない」などの論理的根拠が必要です。そのような強い根拠がない場合は、通常、「差が無い」とだけ表現します。もちろん、分析の結果として、どちらかが明らかに高かった（他方が明らかに低かった）ことが分かる場合がありますから、その理由を考察するのは大事なことです。 ふたつの仮説を整理しておきましょう。 帰無仮説：サークル所属している学生の満足感の平均値=サークル所属していない学生の満足感の平均値 対立仮説：サークル所属している学生の満足感の平均値≠サークル所属していない学生の満足感の平均値 5.2.2 使用するデータ 使用するデータ（仮想データ）は次のものです。本書では以下、Excelによる計算手順を示していきますので、いっしょに計算しながらお読みいただくと、理解が深まるかもしれません。 まず、Excelの新しいシートに、次のようにデータを入力してください。セル番地についてよくご存知の方は、お好きなシートのお好きな位置に入力していただいてかまいません。が、計算式の入力になれていない方は、図の通りの位置に入力されることをおすすめします。D列からI列も、今のうちに入力しておいてください。ここに、偏差平方和を計算する式を入力します。 Figure 5.1: 仮想データの入力 5.2.3 表記方法の確認 これから分散分析をするための計算をしていくとき、記号で表現したほうが見やすくなったり、他の分析に応用しやすくなったりすると思いますので、ここで、記号の使い方について整理し、帰無仮説と対立仮説も、記号を使って書き直しておきます。計算の説明では、適宜、記号の意味を補っていきますが、迷子になったらここにもどって、記号の意味を確認してください。 まず、満足感というデータをxで表します。回答者によって値がことなりますから、xという変数は出席番号つきで、xiと表します。サークルに所属しているか否かで満足感の平均値を比較したいという目的がありますから、サークルに所属しているかどうかを、記号で表します。サークルに所属している群をA群、していない群をB群とし、これにあわせて、データの出席番号も、A群はxAi、B群はxBiと書き分けることにします[*]。たとえば、xA1はA群（サークルに所属している群）の1番のデータで、xB2は、B群（サークルに所属していない群）の2番目のデータです。 ＊サークルに所属している、という状態を「1」、そうでない状態を「0」というように表す方法も一般的です。このように、回答者を単に2つのグループに分けるためだけに設定される変数をダミー変数といいます。ここでは、データの出席番号と混同しないように、ダミー変数ではなく、A、Bという文字をそのまま使います。 次に、A群とB群で満足感の平均値を比較したいというのが分析の目的ですから、それぞれの平均値を記号であらわす必要があります。平均値は\\(\\bar x\\)で表しますから、どちらの群の平均値であるかわかるように、A群の平均値を\\(\\bar x_A\\)、B群の平均値を\\(\\bar x_B\\)と表すことにします。ただし、帰無仮説では、平均値がまったく同じであるとしていますから、その場合の平均値、つまり全体の平均値を、\\(\\bar x\\)と、添え字なしで表すことにします。 それから、標本サイズ（データ数）もA群とB群とを別々に表記できるように、A群、B群の標本サイズをそれぞれnA、nBと書くことにします。また、全体をあわせたときのデータ数はNと書きます。わざわざ大文字を使うのは、目立つようにするためで、それ以上の意味はありません。以上のことを、表に整理しておきます。 Figure 5.2: 表記方法の整理 帰無仮説と対立仮説も、これらの記号を使って表現しておきましょう。まず帰無仮説は、「サークル所属している学生の満足感の平均値\\(=\\)サークル所属していない学生の満足感の平均値」でしたから、記号で書くと、 \\[\\bar x_A = \\bar x_B\\] です。対立仮説は、帰無仮説を単純に否定する形で書きますから、 \\[\\bar x_A \\ne \\bar x_B\\] です。では、計算を進めていきましょう。 "],["s53_analysis.html", "5.3 分散分析", " 5.3 分散分析 前節で設定した記号を使いながら、計算を進めていきます。分散分析という名前がついていますが、最初に計算するのは偏差平方和です。偏差平方和をどのように分解するのか、そしてそれらを、どの自由度で割るのかが、おそらく分散分析のわかりにくさだろうと思います。一つずつ、ていねいに見ていきましょう。前節で示したデータを使いながら、ぜひ一緒に計算しながらお読みください。 まず、帰無仮説が妥当であるという仮定のもとで、偏差平方和を計算します。つまり、2つの群で平均値がまったく同じだと考えると、偏差平方和はいくつになるかを計算します。ここが分散分析の出発点です。 5.3.1 平均値がまったく同じだとする仮説 まず、帰無仮説のもとで、偏差平方和を計算します。「帰無仮説のもとで」という表現は次のことを意味しています。 帰無仮説は、A群（サークル所属あり）・B群（所属なし）で、満足感の平均値にまったく差がないと考えていた。 満足感の平均値にまったく差が無いということは、どちらの群も同じ平均値を使うということだ。 だったら、A群もB群もまぜてしまって、全体で平均値\\(\\bar x\\)を計算して、その平均値を使えばいい。 面倒なことを書いていますが、結局、A群とかB群とか気にしないで、全員分の平均値を計算して、ふつうに偏差平方和を計算する、という手順と同じです。これを、「帰無仮説のもとで」と表現しているのです。 帰無仮説のもとで計算された偏差平方和を、分散分析では、「全平方和」とよびます。「全部のデータ」と「全体の平均」を使って偏差を計算しているので「全」という字がくっついているのだと理解してよいでしょう。「全体」をあらわすtotalの頭文字を添え字につけて、SSTという記号で書きます。数式で表記するとこのようになります。 \\[SS_T = \\sum_{i=1}^N (x_{i} - \\bar x)^2\\] なお、これまでの章のように具体的な数値を使った数式ではなく、本章では一般的な数式のみで説明します。それぞれの記号が何を表しているのか、そして、具体的にはどの数値がそこで使われているのかを確かめながら読み進めてください。 5.3.2 平均値と偏差平方和（Excel） 次に進む前に、Excelで全平方和をどうやって計算するのかを解説します。ご自分で計算できる方は、飛ばして先に進んでください。実際に数式を入力するときには、次のことを注意してください。 日本語入力はOFFにして、すべて半角で入力します。数式の記号に漢字やひらがなが混ざると正しく動作しません。 説明ではアルファベット大文字をつかっていますが、小文字で書いても同じように動作します。（入力が完了すると、Excelが自動的に大文字に直します。） 説明ではところどころ、読みやすさを考えて空白（半角スペース）を入れていますが、この空白は入力の必要がないものです。 まずデータの合計を計算する データの合計は本来必要のない値ですが、入力の練習としてぜひ行ってください。〔E3〕セルに、次の式[*]を入力します。210と表示されるはずです。 〔E3〕 = SUM ( A2 : B16 ) ＊「次の式」とは、「=」ではじまる文字列全体です。先頭の「=」は、これから数式を入力しますよ、という合図で、かならず必要です。次のSUMは、合計を計算する関数の名前、そして、かっこの中に、合計したい数値が入力されているセルの場所を書きます。前掲の図の通りの場所にデータが入力されているという前提で書いています。 もし、表示される数字が違っていたら、A列、B列のデータがどこか間違っていると思われます。もう一度確認してください。もし、#NAME?のような文字が表示されたら、入力した式がどこか間違っています。Delキーで消して、もう一度試してください。以後、これ以上細かい説明をしませんので、困ったときは、書籍などを参照してください。 データの平均値を計算する データの平均値を計算するには、関数の名前をSUMからAVERAGEに変えます。あとは同じです。結果は「7」と表示されると思います。 〔E4〕 = AVERAGE ( A2 : B16 ) データの偏差の合計を計算する 合計を計算しますから、関数はSUMを使います。合計したいのは偏差ですから、かっこの中に「データ－平均値」という式を入力します。データはA2:B16、平均値は、さきほど計算したE4にあります。結果は「0」と表示されると思います。 〔E5〕 = SUM ( A2:B16 - E4 ) 偏差平方和を計算する 偏差を計算する方法がわかりましたから、それを二乗してからSUMで合計します。二乗の計算は、^2と書きます。かっこが二重になるのでお気を付けください。結果は「52」と表示されると思います。 〔E6〕 = SUM ( ( A2:B16 - E4 )^2 ) 分散分析に必要なのは、最後に計算した偏差平方和（SST=52）です。ここまでで、シートは次のようになっていると思います。 Figure 5.3: 全平方和の計算 5.3.3 平均が異なるとする仮説 帰無仮説のもとでの偏差平方和、すなわち全平方和SSTを計算することができました。次は何をするかというと、A群（サークル所属あり）・B群（所属なし）に分けて、それぞれの偏差平方和を計算して足し合わせます。計算する前に予想してください。このときの偏差平方和は、たったいま計算した「全平方和SST」よりも大きくなると思いますか、小さくなると思いますか。なぜそう思いますか。本書ですでに解説したことをが理解されていれば、正しく予想できると思います。ヒントは、A群にとっての「正しい」平均値はどの値なのか、ということです。 では、帰無仮説をいったん忘れて、群ごとに平均値は異なるという仮説のもとで偏差平方和を計算しましょう。A群（サークル所属あり）・B群（所属なし）は平均値が異なるのだから、それぞれの平均値を使って、別々に偏差平方和を計算して、あとから合計しようというのです。 A群のデータを使ってA群の平均値\\(\\bar x_A\\)を計算し、それを用いてA群の偏差平方和を計算する。 B群についても同様に行う。 両者を合計する。 この平方和を、分散分析では「郡内平方和」とよびます。A群、B群それぞれについて、その群にふくまれるデータと、その群の平均値を使って偏差を計算しているので「群内」というのだと理解してよいでしょう。群内平方和はSSeという記号で表すことにします[*]。数式で書くと次のようになります。 \\[SS_e = \\sum_{i=1}^{n_A} (x_{Ai} - \\bar{x}_A)^2 + \\sum_{i=1}^{n_B} (x_{Bi} - \\bar{x}_B)^2\\] ＊この「e」はerrorの頭文字と理解します。errorはミスとか間違いという意味ではなく「誤差」です。分散とは、個体差あるいは個人差としか表現できないようなデータのばらつきであるという話をしましたが、ここでの「誤差」もこれと同じような意味です。 5.3.4 群ごとの平均値と群内平方和（Excel） 群内平方和の計算は、全平方和の計算とほとんど同じ手順です。違うのはデータの入力範囲の指定だけです。全平方和のときは、データの範囲をA2:B16としていました。これをA2:A16として、まずA群だけの群内平方和を計算します。つぎに、データ範囲をB2:B16として、B群だけの群内平方和を計算します。最後に2つの平方和を合計します。ここでは、計算に必要な平均値と偏差平方和のみ計算式を示します。 データの平均値を計算する：次のように〔G4〕〔H4〕セルに入力します。結果は、〔G4〕セルには7.4、〔H4〕セルには6.6と表示されると思います。 〔G4〕 = AVERAGE ( A2 : A16 ) 〔H4〕 = AVERAGE ( B2 : B16 ) 2. 偏差平方和を計算する：次のように〔G6〕〔H6〕セルに入力します。結果は、〔G4〕セルには21.6、〔H4〕セルには25.6と表示されると思います。 〔G6〕 = SUM ( ( A2:A16 - G4 )^2 ) 〔H6〕 = SUM ( ( B2:B16 - H4 )^2 ) 群内平方和を計算する：〔G6〕にはA群の、〔H6〕にはB群の偏差平方和を計算しましたので、これを合計した値が群内平方和です。〔I6〕セルに、次の式を入力します。 〔I6〕 = G6 + H6 結果は47.2と表示されると思います。これが群内平方和です。群内平方和の方が小さくなりました。その差は52-47.2=4.8です。 Figure 5.4: 群内平方和の計算 5.3.5 「全平方和＞群内平方和」の意味すること 群内平方和SSeを全平方和SSTと比べると、4.8だけ差があることが分かります。この数値の意味について、第3章の内容を振り返りながら確かめておきましょう。第3章「分散公式を読み解く」でわかったことは次のことでした。 正しく計算した平均値の代わりに、整数に丸めた平均値を使って偏差平方和を計算すると、平均値同士の差、つまり「丸め誤差」の2乗のn倍だけ、偏差平方和は大きくなりました。推測統計では、偏差平方和を自由度で割って、分散の値を少しだけ大きめにする理由についても、「丸め誤差」を「標本平均値と母平均の差」と読みかえて説明してきました。群内平方和と全平方和の差は、これらと同じ論理で説明できます。 本章の設定では、A群にとっての正しい平均値は\\(\\bar x_A\\)、B群にとっての正しい平均値は\\(\\bar x_B\\)です。群内平方和を計算するときには、これらの値を使って計算しました。ところが、全平方和を計算するときには、これらの代わりに、全体の平均、つまり\\(\\bar x\\)を使っていました。つまり、A群については\\(\\bar x_A - \\bar x\\)が、B群については\\(\\bar x_B - \\bar x\\)が、それぞれの「平均値どうしの差」です。どちらの群についても、この「平均値どうしの差」の2乗のn倍だけ平方和の計算誤差が生じたわけです。実際に計算してみましょう。A群については、 \\[(\\bar x_A - \\bar x)^2 \\times n_A = (7.4 - 7.0)^2 \\times 15 = 0.4^2 \\times 15 = 0.16 \\times 15 = 2.4\\] であり、同じくB群については、 \\[(\\bar x_B - \\bar x)^2 \\times n_B = (6.6 - 7.0)^2 \\times 15 = (-0.4)^2 \\times 15 = 0.16 \\times 15 = 2.4\\] です。合計すると4.8です。本章の設定においては、これが「無駄に大きくなっていた平方和」です。「無駄に大きくなっていた平方和」をここまでの計算で取り除くことができたのです。上述の議論から明らかなように、平方和の大小関係はつねに「全平方和＞群内平方和」であり、どんなデータであろうと、この関係はくずれません。では、何が要因となって平方和が無駄に大きくなっていたのか、それをどのように評価すればよいのかが、分散分析後半の課題です。が、その前に、自由度を取り入れる必要があります。 5.3.6 自由度で割って比較する 全体の平均値を使った場合と、群ごとの平均値を使った場合とで、偏差平方和にどれだけ差があるかはわかりました。しかし、この数値をそのまま用いるわけにはいきません。どうしてでしょうか。 前節で「無駄に大きくなっていた平方和」を計算するとき、「平均値どうしの差」2乗のn倍と計算しました。この「n倍」というのが問題なのです。n倍するということは、標本サイズが大きくなれば、偏差平方和の差もその分大きくなります。偏差平方和の差が大きいのは、単に標本サイズが大きいからではなく、平均値の差が大きいからだ、ということを分散分析では示したいのです。 このことから、私たちはさらに2つのことを考えなければならないとわかります。つまり、 全平方和と群内平方和を、標本サイズnの影響をなくした形に計算し直すこと 平均値の差がどのくらい大きいのかを、平方和の差をもとに計算すること はじめに、標本サイズの影響をなくすことについて考えましょう。これは、偏差平方和を自由度で割るという方法で解決します。標本サイズではなく自由度で割るのは、母分散の推定値として分散を使うときには、実際には自由度である(n-1)個ぶんのデータしかないように見えているからでした。 全平方和は、30人分のデータをすべて使っていますから、全平方和の自由度は30-1=29です。群内平方和は、A群の平方和の計算で15人分のデータを使っていますから、自由度は15-1=14です。B群でも同じく15-1=14ですから、群内平方和の自由度は14+14=28です。 全平方和と群内平方和には、「全平方和＞群内平方和」という関係があることはすでに確認しましたが、自由度にも、「全平方和に対応する自由度＞群内平方和に対応する自由度」という関係があることが分かりました。この差について、もう少し考えます。 5.3.7 平均値を選ぶ「自由」の数 ここまでの計算結果を、「全体の平均値をつかって、全平方和を計算されてしまったデータ」の立場にたって考え直してみましょう。 偏差平方和をデータ数で割った値、すなわち「分散」は、データの散布度あるいは密集度をあらわす重要な指標でした。また、平均値は、偏差平方和を最小にする値でした。ところが、全平方和の計算では、群による平均値の違いを無視した、全体の平均値を使って計算したものです。データの立場から、この状況を見てみましょう（以下、無理やりに擬人化した感じの話になります）。A群に所属するデータから見れば、「ああ…、この平均値ってさあ、ぼくたちA群の平均値じゃないのになあ。これじゃ平方和が大きくなりすぎちゃうよ」のように見えているでしょう。B群に所属するデータからも、「なんだよその平均値は。どこから来たんだよ。ちゃんとB群の平均値を使ってくれよ」のように見えているに違いないのです[*]。 ＊私にはデータの声が聞こえるのだ、などという超能力的な話をしているのではありません。こんなふうに書いたら面白いのでは、と思って、ちょっと遊んでみたのです。もう少し続きますので、お付き合いください。 サークル所属あり群（A群）とサークル所属なし群（B群）とでは、多少なりとも平均値は違うはずだ。それが大きな差なのか、小さな差なのかはさておいて、差がないなどと考えるのは間違っている。そう思ったデータたちは、こう叫ぶに違いありません。 「ぼくらの平均値を返せ！ ぼくらは、ぼくらの平均値を選ぶ自由がある！」 そして、彼らは、自分の群の平均値を取り返します。 ただしこのとき、平均値を取り返すのはどちらか一方の群で十分です。たとえば、A群が「A群の平均値を使う」と宣言すれば、残されたのはB群だけです。B群だけでは全体の平均値を計算できません。B群は必然的にB群の平均値を使うことになります。 もし、群が3つある場合はどうなるのでしょう。A群が自分たちの平均値を選びます。残されたのはB群とC群です。さらにどちらかが、たとえばC群が「自分たちの平均値を使う」と宣言すれば、残されたのはB群だけで、B群は必然的に自分たちの平均値を使うことになります。 このように考えると、「ぼくたちの平均値を使うのだ」と宣言するのは、2つの群の内の1つ（群が3つのときは、3つの群のうち2つ）で十分で、残された群の平均値は自動的に決まってしまうことがわかります。 つまり、この「平均値を選ぶ」という分散分析特有の操作において、「群の数より1小さい」数だけの「平均値を選ぶ自由」があるということです[*]。 ＊このあと、もう一つの自由度（群間平方和に対応する自由度）の話をしますが、私はここに記したような、（いささか安っぽい）物語調の解釈が面白いのではないかと思って、書いてみました。同じ内容を、別の角度から論理的に解き明かしたものとして、中原（2022）があります。とても面白い解説ですので、ぜひ読んでみてください。 5.3.8 平方和の差を自由度で割る 全平方和と群内平方和を、どのような自由度で割ればよいかはすでに解決していました。「群ごとの平均値を使う」ことによって生じた「平方和の差」に対しても、上で述べたように、自由度を考えることができました。 まず平方和の名前を確かめましょう。ここまで「全平方和と群内平方和の差」とだけ書いてきましたが、分散分析の用語では「群間平方和」とよびます。記号ではSSAと書きます。群ごとの平均値を使うことで生じた差なので、群と群の間に生じた平方和、という意味に解釈すればよいでしょう。 そして、「群間平方和」の自由度は、上で解説したように「群の数-1」です。ここではA群・B群の2つの群がありますから、自由度は1です。どちらか一方の群が、全体の平均値ではなく、自分の群の平均値を使って平方和を計算するのだ、と宣言すれば、残された群も、平方和の計算に自分たちの群の平均値を使わざるをえません。ですから、「群の数-1」が自由度になります。 "],["s54_anova_table.html", "5.4 分散分析表", " 5.4 分散分析表 さて、以上で、分散分析の準備がととのいました。これを、以下のような表に整理するのが、分散分析の一般的な手法です。この形式の表を「分散分析表」といいます。Rなどの分析ソフトや、Excelの「分析ツール」、HADでも同様の表が出力されます。ただし、使われている用語が異なっていますから、どれか一つ（お使いの教科書の用語で理解するのが良いと思います）に読み替えて理解しましょう。 Figure 5.5: 分散分析表 Excelで計算しながら読み進めている方は、図の右下のような分散分析表を作成してください（罫線はなくてもかまいません）。以下、計算式も示しながら解説を続けます。 5.4.1 平方和と自由度 3つの平方和と自由度については、これまでに説明してきましたので繰り返しません。下の図のように、分散分析表の中に書きこんでください。 Figure 5.6: 平方和と自由度の記入 5.4.2 分散あるいは平均平方 自由度を考えるのは、標本サイズの影響をなくすためでしたから、それぞれの平方和を自由度で割るのが次の計算です。平方和を自由度で割った値のことは、一般に「分散」といいます。ただし分散分析の用語では、「平均平方」という用語がよく使われます。3種類の平方和を呼び分けたように、分散あるいは平均平方も呼び分けることが可能です。 「全平方和」を、対応する自由度でわった値が「全分散」あるいは「全平均平方」、「群内平方和」を対応する自由度でわった値が「郡内分散」あるいは「郡内平均平方」です。最後に、「群間平方和」を対応する自由度でわった値が「群間分散」あるいは「群間平方和」です。Excelに入力する式は次のものです。 〔G11〕 = E11 / F11 〔G12〕 = E12 / F12 〔G13〕 = E13 / F13 Figure 5.7: 分散あるいは平均平方の計算 なお、計算結果が何桁まで表示されるかは、Excelのフォントサイズや、セル幅によって違います。式が正しく入力されていれば、計算結果表示の細かい違いを気にする必要はありません。気になる方は、セル幅を調整する、フォントサイズを変えるなどして調整してください。ただし、四捨五入して入力し直すことはおすすめしません。間違いのもとになりますし、この先の計算結果に余計な誤差が紛れ込むおそれがあります。 "],["s55_stat_judge.html", "5.5 判断のための2つの指標", " 5.5 判断のための2つの指標 さて、分散分析の計算の部分はほぼ終わりました。でも、まだ問題は解決していません。なぜなら、推測統計は、標本データがどうなっているかではなく、そこから推測される「母集団」の特徴に興味があるのです。結局、母集団においても、A群とB群で満足度に差はあるのだろうか。具体的に言い直すと、放送大学の学生の学習達成に対する満足感は、サークルに所属している学生と、サークルに所属していない学生とで差があるのだろうか、という問題に、統計的な判断をしたいのです。この判断のために、分散分析表を使って2つの数値を計算するのが普通です。ひとつは分散比（F値）とそれに対応するp値、もうひとつは分散説明率（または決定係数）です。 5.5.1 分散比（F比、またはF値） 統計的判断のための第一の指標は、分散比（F比、またはF値）です。分散比は、群間分散（群間平均平方）と、郡内分散（郡内平均平方）の比を示したものです。それぞれの分散がどのような意味を持っているのかを確かめ、分散比の意味を考えましょう。 群間分散SSAは、データを群に分けることによって生じた平方和の差（群間平方和）を、群間の自由度で割ったものです。群間の自由度の回数だけ、平均値を選ぶことによって平方和を小さくできました。もともと群に分けられていたはずなのに、それを無視し、全体平均を使って平方和を計算した結果、全平方和は無駄に大きくなっていました。その「無駄に大きくなっていた平方和」が、自由度で割られた群間分散としてここに表れているのです。しかし、群間分散が大きいか小さいかを判断するためには、比較する相手が必要です。その相手は、郡内分散です。 郡内分散SSeは、「誤差分散」と呼ばれることもあります。分析では明らかにできていない（その多くは要するに個人差かもしれない）部分です。記述統計における分散も、同じような意味を持っていました。全体の分散から、群間分散を取り除くことで、本当に誤差（個人差）と呼べるものは、おそらくこれだけだったのだ、と明らかになった部分、それが郡内分散（誤差分散）です。 群間分散SSAが、群内分散SSeに比べて大きいということは、「全分散はすべて誤差だと考えるのは妥当ではない。なぜなら、群を分けてそれぞれに分散を計算してみたら、郡内分散SSeがこんなに小さくなった。つまり群間分散SSAという名の「無駄に大きくなっていた分散」がこんなにあったということだ。だから、群に分けて分析するのがとても意味のあることだ。やっぱり帰無仮説じゃだめなんだよ。」という理解につながります。 逆に、群間分散SSAが郡内分散SSeに比べてさほど大きくないということは、「群にわけて計算してみたけれど、郡内分散SSeは大きく変化していない。「無駄に大きくなっていた分散」は確かにあったけど、たいした大きさじゃない。どの群も同じ結果だという帰無仮説を、否定するほどじゃない」という理解につながります。 以上のことを理解したうえで、分散比（F比）を計算してみましょう。 \\[F = SS_A / SS_e = 4.8 \\div 1.686 = 2.847\\] 〔H11〕 = G11 / G12 この値が何を意味するかは、確率統計について学習し、F分布やp値について理解する必要があります。また、この値がどれくらい大きいのかも、F分布表を見て判断しなくてはいけません。本書ではごく簡単に、解釈の方法を記しておきます。 5.5.2 p値 分散比の意味を明らかにしてくれる指標が「p値」です。p値とは、前節で計算した分散比（F値）を、群間分散の自由度と郡内分散の自由度を参照して確率に変換した値です。確率に変換する計算は、手計算で行うことはできません。ここだけは、統計ソフトを使う必要があります[*]。Excelでは次の式です。（注意：「F.DIST.RT」はこれだけで一つの関数です。途中にスペースを入れると正しく動作しませんのでご注意ください。） 〔I11〕 = F.DIST.RT( H11, F11, F12) ＊統計学の入門書には、付録として確率分布表が掲載されており、そのなかにF分布表も含まれていることがあります。これをつかうと、「少なくともp値は0.05より大きい」のような簡易的な判断をすることは可能です。ただし、参照したい自由度の組合せがすべて掲載されているわけではありません（そんなことをしたら、ものすごく巨大な表になってしまいますから）。また、論文やレポートでは、正確なp値を報告することが推奨されています。したがって、統計ソフトを活用して、p値を計算する手順を覚えることは重要です。 結果は、0.1026などと表示されます。約10.26％ということです。ここで求められた確率は、帰無仮説のもとで、「分析したデータと同じくらい平均値に差があるようなデータ（あるいはもっと差が大きいデータ）が、どのくらいの確率で得られるか」を表しています。 この確率がそれほど小さくないとき（通常5％以上）、「これくらいの平均値の差があるデータが得られる確率はそれほど小さくないので、たしかに平均値に差はあるけれど、たまたま差があっただけだと考える方が妥当であり、帰無仮説を否定するほどのことはない」ということです。このとき、帰無仮説は「保留」されたと結論し、「平均値には統計的な差はなかった」あるいは「有意差はなかった」などと表現します。 この確率がかなり小さいとき（通常5％未満）、「これくらい（またはそれ以上）の差があるデータが得られる確率はかなり小さいので、たまたま差があると考えるのは無理がある。よって、帰無仮説が妥当ではなかった」ということです。このとき、帰無仮説を「棄却」し（妥当ではないという判断をくだし）、対立仮説が「支持」されたと結論します。そして、「平均値には統計的な差があった」あるいは「有意差があった」などと表現します。 計算された確率は、約10.26％でしたから、10％くらいの確率で（つまり10回に1回くらいは）これくらいの差があるデータは得られる、ということです。慣例的には、5％より確率が高いので、帰無仮説は保留されました。サークルに所属しているか否かで、放送大学の学習達成に対する満足感の平均値には、統計的な差はない（有意差はない）といえます。 完成した分散分析表はこうなっていると思います。 Figure 5.8: 完成した分散分析表 帰無仮説を「棄却」する 統計的仮説検定では、帰無仮説を設定して計算を進め、p値の解釈も、帰無仮説のもとではどうなのか、という考え方をします。その結果、帰無仮説が妥当であるかどうかを判断するのですが、これをどう表現するのかは少々やっかいです。 帰無仮説が妥当ではないと判断することを、「棄却する」といいます。「棄却」は、辞書的には「捨てて取り上げないこと」という意味です。裁判の報道で「控訴が棄却された」のような使い方を耳にすることがあると思います。 帰無仮説が妥当ではなく「棄却」されたら、かわりに対立仮説が採用されるのかと思いきや、こちらは、対立仮説を「支持する」といいます。ここで「正しい」と言っていないのがポイントです。「今回のデータは、対立仮説が正しそうだと言っている（＝支持している）けれど、別のデータだったら違う結果になるかもしれない」という意味合いです。なぜかというと、帰無仮説が「棄却」されるのは、そのようなデータ（あるいはもっと極端なデータ）がたまたま発生する確率が、小さいとはいえ数％はあるからで、今回のデータが、その「数％しかないたまたま」であった可能性は否定できません。対立仮説が「正しい」と言い切ってしまうことはできないのです。 では逆に、帰無仮説が妥当であった場合はどうでしょう。これも、帰無仮説を「棄却せず」とか、帰無仮説を「保留する」という言い方をします。やはり、帰無仮説が「正しい」とは言いません。今回のデータでは、帰無仮説を棄却できなかったというだけのことです。もっと大規模な調査をすれば、帰無仮説が棄却されるかもしれませんし、サークルの活動内容によって、帰無仮説が棄却される場合があるのかもしれません。 もうひとつ付け加えると、本書では、帰無仮説を棄却するかどうかの判断基準を、p値が5％以上か、それ以下かとしていますが、このことに論理的な根拠があるわけではありません。慣例として5％という基準が使われることが多いというだけのことです。 5.5.3 分散説明率 統計的判断のための第二の指標は、「分散説明率」です。分散説明率は「決定係数」ともいい、R2（アール二乗）という記号で表します。 考え方は、群内平方和SSeが、全平方和SS~T_にくらべて何％くらい小さくなっているか、ということです。言い換えると、群間平方和SSAは全平方和SSTの何％だったかということです。自由度でわる前の、平方和の値どうしで計算をしていますが、考え方は分散比（F値）とよく似ています。なぜこれが必要かというと、分散比（F値）の場合は、標本サイズが大きくなると、大きくなりやすい、つまり、統計的に有意と判断されやすいという特徴が残ってしまっているからです。 でも、標本サイズの影響をなくすために自由度で割って分散（平均平方）を求めたたはずなのに、なぜそれを使わないのでしょうか。なぜ平方和にもどってまで、別の指標を計算しようとしているのでしょうか。 それは、標本サイズが大きいと、群間平方和が大きくなりやすいからです。群間平方和SSAは、全平方和と群内平方和の差でしたが、平均値同士の差の2乗のn倍でも計算することができました。このn倍が問題なのです。標本サイズ（n）が大きくなれば、その分だけ群間平方和SSAは大きくなりますが、群間の自由度は、群を増やさないかぎり変わりません。その結果、分散比は大きくなってしまいます。もちろん、標本サイズを大きくすることで群内分散も変化しますが、それより、群間平方和が大きくなることのほうが影響が大きいのです。 そこで、統計的に有意になったけれど、実際に平方和はどれくらい小さくなっているのか、無駄に大きくなっていた平方和は全平方和のうちどれくらいの割合なのかを計算して、本当に群に分ける意味があるのかを、考えようとしているのです。計算式は、次のものです。 \\[R^2 = SS_A / SS_T = 4.8 \\div 52 = 0.092\\] 〔D15〕 = E11 / E13 分散説明率（決定係数）R2は0.092（約9％）でした。百分率で表せるので、比較的解釈のしやすい指標です。が、やはりこの数字も、大きいか小さいかを一般的に判断する基準はありません。学習達成に対する満足感のような心理学的な傾向には、おそらく多数の要因がかかわっていますから、通常、ひとつの要因の分散説明率が数十％にのぼることは考えにくいです。サークル所属の有無というたったひとつの要因で、ほんとうに9％ほどの分散説明率があるとしたら、それなりに重要な要因であると考えることもできそうです。このあたりは、本書の範囲を大きく超える部分ですので、これ以上の議論はしません[*]。 Figure 5.9: 分散説明率を追加 ＊そもそも架空データでの話ですので、本当にサークルに所属するかどうかで満足感の平均値が異なるかどうかは、全くわかりません。また、そのように予想する根拠もありません。 "],["おわりに.html", "おわりに", " おわりに 本書では、まず総和記号の働きについて復習しました。そして、第2章の最後に、私がかつてかかえていた疑問について書きました。それは、「データの平均値が6.2など小数になったときに、整数に丸めて（平均値が6であるということにして）分散を計算してよいのか」というものでした。第3章では、この問題を解決しました。分散定義式を分散公式に変形する過程を応用しながら、平均値を丸めて計算した「誤った偏差平方和」が、どのくらいの計算誤差を含んでいるのかを考えました。その結果、誤った偏差平方和は、正しい偏差平方和に比べて、「丸め誤差」の2乗のn倍だけかならず大きくなることが分かりました。第2章で解説してきた、シグマくんこと総和記号の変身術を使うことによって、複雑に見えた数式がきれいに整理されていく過程をみることができました。 これらの話をうけて、第5章では分散分析を実際にやってみました。そして、統計用のツールを使わずに、Excelの計算式だけで分散分析表をつくってみました。手計算で分散分析表をつくっていくのはけっこう手間のかかる作業ですが、一要因の、小規模なデータならばという条件はつきますが、Excelで計算は可能です。そして、全体平均を使って計算された全平方和は、群ごとに計算した平方和の合計よりもかならず大きくなること、その原因は、「全体平均と群ごとの平均とが異なる値である」という、いわば当然の事実によること、全平方和と群内平方和の差は、平均値どうしの差の2乗のn倍という形で計算できることなどを説明してきました。これらが、私のかつての疑問「平均値を整数にまるめて計算してよいのか。もしそのように計算したら、どれくらいの計算誤差が出るのか」と地続きであることをご理解いただけたのではないかと思います。 ただし、上記のことをできるだけ平易に説明するために、分散分析としてはあまり一般的でない「2つの群の平均値の比較」という設定で計算を進めてきました。もちろん、群が3つになっても、それ以上になっても、同じように考えて計算できます。また、本書では2つの群のnが等しい設定で説明していますが、現実には、群ごとにnが異なることもあります。そういう場合にも、本書と同様の手続きで分散分析表をつくることができます。ぜひ、チャレンジしてみてください。 本書では、私が統計学を学び始めたころに感じた疑問を解き明かしていく過程を軸に、分散分析の理解につながる心理統計のエッセンスをお話ししてきました。お楽しみいただけましたでしょうか。本書を通じて、何か新しい気づきが得られたのであれば幸いです。 本書をまとめようと思い立ったのは、2023年の11月末、あるポッドキャスト放送がきっかけです。ここでその放送内容に触れることはしませんが、学習した知識や、それをもとに考えてきたことをまとめておこうと思い立ちました。本書の内容は、これまでばらばらにWeb上の媒体に書いてきたことをもとに、順序だて、あらたに書き加えた内容もあわせてまとめたものです。 新しい理論を提示しているわけでもありませんし、何か面白そうなデータが示してあるわけでもありません。私が、私自身がいだいた疑問を解決していく過程でおこなった、さまざまな試行錯誤や実験などを整理して提示することで、統計学の学び直しに活用していただけたらと思います。 本書をまとめるにあたり、これまで履修してきた（履修していないものも含めて）放送大学の教科書、そこで参考文献に掲げられていたいくつかの専門書を参考にさせていただきました。また、日本心理学会主催の数学ワークショップでも、たくさんの刺激をいただきました。教科書の執筆やテレビ・ラジオ講義、専門書の出版、日本心理学会数学ワークショップなどに関わってこられた、すべての研究者の皆様、関係者の皆様に御礼申し上げます。 最後までお読みいただき、ありがとうございました。 "],["参考文献.html", "参考文献", " 参考文献 心理統計に関する書籍など 南風原朝和 (2002) 心理統計学の基礎 統合的理解のために. 有斐閣. 林 拓也（編著） (2024) 三訂版 社会統計学入門. 放送大学教育振興会. 小杉考司, 紀ノ定保礼, 清水裕士 (2023) 数値シミュレーションで読み解く統計のしくみ Rでためしてわかる心理統計. 技術評論社. 中原 治 (2022) 基礎から学ぶ統計学. 羊土社. 清水裕士（編著） (2021) 心理学統計法. 放送大学教育振興会. 吉田寿夫 (1998) 本当にわかりやすいすごく大切なことが書いてあるごく初歩の統計の本. 北大路書房. bookdown, R markdown に関するサイトなど Yihui Xie (2024) bookdown: Authoring Books and Technical Documents with R Markdown. https://bookdown.org/yihui/bookdown/ Yihui Xie, Christophe Dervieux, Emily Riederer, 片桐 智志（訳） (2022) R Markdown クックブック. https://gedevan-aleksizde.github.io/rmarkdown-cookbook/ "],["著者自己紹介.html", "著者自己紹介", " 著者自己紹介 Almond Fish （Motofumi KOZAKAI） 2013年10月放送大学教養学部（心理と教育コース）入学、2017年9月卒業。その後人間と文化コースに学士入学し、2023年9月まで在籍。2018年4月放送大学大学院文化科学研究科（人間発達科学専攻）入学、2020年3月修了。入学のきっかけは臨床心理学で、河合隼雄先生のように、昔話を読み解けたら楽しいだろうと考えていた。履修をはじめてから社会心理学や統計学の面白さに目ざめる。卒業・終了後も、心理学系の科目や統計学の科目を、履修もしていないのに教科書を買い、放送大学の単位認定試験過去問を解くという謎の行動に走る。その後、日本心理学会主催の数学ワークショップに参加したことと、「数値シミュレーションで読み解く統計のしくみ」を読んだことをきっかけに、統計の学習に活かせるアニメーションの作成に没頭する。詳しくは下記のWebページを参照してください。 ブログ：「趣味の統計」 https://almondfish.hatenablog.com/ Webページ：「アニメーションによる統計学習」 http://almondfish.starfree.jp/index.html "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
